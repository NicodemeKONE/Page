<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nicodeme KONE">

<title>Régression Linéaire Multiple</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Regression_LM_files/libs/clipboard/clipboard.min.js"></script>
<script src="Regression_LM_files/libs/quarto-html/quarto.js"></script>
<script src="Regression_LM_files/libs/quarto-html/popper.min.js"></script>
<script src="Regression_LM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Regression_LM_files/libs/quarto-html/anchor.min.js"></script>
<link href="Regression_LM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Regression_LM_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Regression_LM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Regression_LM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Regression_LM_files/libs/bootstrap/bootstrap-0b3b9638000aa634054a1a0e4b24ad6b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#projet-regression-linéaire-multiple" id="toc-projet-regression-linéaire-multiple" class="nav-link active" data-scroll-target="#projet-regression-linéaire-multiple"><span class="header-section-number">1</span> Projet Regression Linéaire Multiple</a>
  <ul class="collapse">
  <li><a href="#installation-des-bibliothèques" id="toc-installation-des-bibliothèques" class="nav-link" data-scroll-target="#installation-des-bibliothèques"><span class="header-section-number">1.1</span> Installation des bibliothèques</a></li>
  <li><a href="#chargement-des-données" id="toc-chargement-des-données" class="nav-link" data-scroll-target="#chargement-des-données"><span class="header-section-number">1.2</span> Chargement des données</a></li>
  <li><a href="#description-du-dataset-mtcars" id="toc-description-du-dataset-mtcars" class="nav-link" data-scroll-target="#description-du-dataset-mtcars"><span class="header-section-number">1.3</span> Description du dataset <code>mtcars</code></a></li>
  <li><a href="#liste-des-variables" id="toc-liste-des-variables" class="nav-link" data-scroll-target="#liste-des-variables"><span class="header-section-number">1.4</span> Liste des variables</a></li>
  <li><a href="#remarques" id="toc-remarques" class="nav-link" data-scroll-target="#remarques"><span class="header-section-number">1.5</span> Remarques</a></li>
  <li><a href="#la-matrice-des-corrélation" id="toc-la-matrice-des-corrélation" class="nav-link" data-scroll-target="#la-matrice-des-corrélation"><span class="header-section-number">1.6</span> La matrice des corrélation</a></li>
  <li><a href="#interprétation-des-distributions-des-variables" id="toc-interprétation-des-distributions-des-variables" class="nav-link" data-scroll-target="#interprétation-des-distributions-des-variables"><span class="header-section-number">1.7</span> Interprétation des distributions des variables</a></li>
  <li><a href="#analyse-des-distributions" id="toc-analyse-des-distributions" class="nav-link" data-scroll-target="#analyse-des-distributions"><span class="header-section-number">1.8</span> Analyse des distributions</a></li>
  <li><a href="#modelisation" id="toc-modelisation" class="nav-link" data-scroll-target="#modelisation"><span class="header-section-number">1.9</span> Modelisation</a></li>
  <li><a href="#significativité-des-variables-seuil-5" id="toc-significativité-des-variables-seuil-5" class="nav-link" data-scroll-target="#significativité-des-variables-seuil-5"><span class="header-section-number">1.10</span> Significativité des variables (seuil 5 %)</a></li>
  <li><a href="#diagnostic-de-multicolinéarité" id="toc-diagnostic-de-multicolinéarité" class="nav-link" data-scroll-target="#diagnostic-de-multicolinéarité"><span class="header-section-number">1.11</span> Diagnostic de multicolinéarité</a></li>
  <li><a href="#visualisation-des-résidus" id="toc-visualisation-des-résidus" class="nav-link" data-scroll-target="#visualisation-des-résidus"><span class="header-section-number">1.12</span> Visualisation des résidus</a></li>
  <li><a href="#modèles" id="toc-modèles" class="nav-link" data-scroll-target="#modèles"><span class="header-section-number">1.13</span> Modèles</a></li>
  <li><a href="#sélection-de-variables-et-critères-dinformation" id="toc-sélection-de-variables-et-critères-dinformation" class="nav-link" data-scroll-target="#sélection-de-variables-et-critères-dinformation"><span class="header-section-number">1.14</span> Sélection de variables et critères d’information</a></li>
  <li><a href="#comparaison-des-modèles-sélectionnés" id="toc-comparaison-des-modèles-sélectionnés" class="nav-link" data-scroll-target="#comparaison-des-modèles-sélectionnés"><span class="header-section-number">1.15</span> Comparaison des modèles sélectionnés</a></li>
  <li><a href="#validation-croisée-loocv" id="toc-validation-croisée-loocv" class="nav-link" data-scroll-target="#validation-croisée-loocv"><span class="header-section-number">1.16</span> Validation croisée (LOOCV)</a></li>
  <li><a href="#et-après-que-faire-du-modèle" id="toc-et-après-que-faire-du-modèle" class="nav-link" data-scroll-target="#et-après-que-faire-du-modèle"><span class="header-section-number">1.17</span> Et après… que faire du modèle ?</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Régression Linéaire Multiple</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nicodeme KONE </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="projet-regression-linéaire-multiple" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Projet Regression Linéaire Multiple</h1>
<section id="installation-des-bibliothèques" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="installation-des-bibliothèques"><span class="header-section-number">1.1</span> Installation des bibliothèques</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration initiale</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Gestion des packages avec pacman</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>, <span class="at">repos =</span> <span class="st">"https://cran.rstudio.com/"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(pacman)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement de tous les packages nécessaires</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(tidyverse, ggthemes, car, glmnet, MASS, corrplot, </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>       gridExtra, broom, performance, GGally, viridis, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>       plotly, kableExtra)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir theme_elegant (version optimisée)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>theme_elegant <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>)),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">15</span>)),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"grey30"</span>),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="chargement-des-données" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="chargement-des-données"><span class="header-section-number">1.2</span> Chargement des données</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Chargement et préparation des données</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> mtcars</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>donnees<span class="sc">$</span>Y <span class="ot">&lt;-</span> donnees<span class="sc">$</span>mpg</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dataset:"</span>, <span class="fu">nrow</span>(donnees), <span class="st">"observations,"</span>, <span class="fu">ncol</span>(donnees)<span class="sc">-</span><span class="dv">1</span>, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset: 32 observations, 11 variables</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Valeurs manquantes:"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(donnees)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Valeurs manquantes: 0 </code></pre>
</div>
</div>
</section>
<section id="description-du-dataset-mtcars" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="description-du-dataset-mtcars"><span class="header-section-number">1.3</span> Description du dataset <code>mtcars</code></h2>
<p>Le jeu de données <code>mtcars</code> est un dataset classique intégré à R, tiré de la publication <em>Motor Trend US magazine</em> (1974). Il fournit des caractéristiques techniques de 32 modèles de voitures (principalement américaines) des années 1970.</p>
<section id="dimensions" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="dimensions"><span class="header-section-number">1.3.1</span> Dimensions</h3>
<ul>
<li><strong>Nombre d’observations</strong> : 32 voitures<br>
</li>
<li><strong>Nombre de variables</strong> : 11 variables explicatives + 1 variable cible <code>Y</code></li>
</ul>
<hr>
</section>
</section>
<section id="liste-des-variables" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="liste-des-variables"><span class="header-section-number">1.4</span> Liste des variables</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mpg</code></td>
<td><strong>Miles per gallon</strong> : consommation de carburant (miles parcourus par gallon)</td>
<td>Quantitative continue (cible <code>Y</code>)</td>
</tr>
<tr class="even">
<td><code>cyl</code></td>
<td><strong>Nombre de cylindres</strong></td>
<td>Quantitative discrète</td>
</tr>
<tr class="odd">
<td><code>disp</code></td>
<td><strong>Cylindrée</strong> (en pouces cubes)</td>
<td>Quantitative continue</td>
</tr>
<tr class="even">
<td><code>hp</code></td>
<td><strong>Puissance</strong> du moteur (en chevaux-vapeur)</td>
<td>Quantitative continue</td>
</tr>
<tr class="odd">
<td><code>drat</code></td>
<td><strong>Rapport de pont</strong> (rear axle ratio)</td>
<td>Quantitative continue</td>
</tr>
<tr class="even">
<td><code>wt</code></td>
<td><strong>Poids de la voiture</strong> (en milliers de livres)</td>
<td>Quantitative continue</td>
</tr>
<tr class="odd">
<td><code>qsec</code></td>
<td><strong>Temps pour parcourir 1/4 mile</strong> (en secondes)</td>
<td>Quantitative continue</td>
</tr>
<tr class="even">
<td><code>vs</code></td>
<td><strong>Type de moteur</strong> : 0 = moteur en V, 1 = moteur en ligne</td>
<td>Binaire (catégorielle)</td>
</tr>
<tr class="odd">
<td><code>am</code></td>
<td><strong>Transmission</strong> : 0 = automatique, 1 = manuelle</td>
<td>Binaire (catégorielle)</td>
</tr>
<tr class="even">
<td><code>gear</code></td>
<td><strong>Nombre de vitesses</strong> du modèle</td>
<td>Quantitative discrète</td>
</tr>
<tr class="odd">
<td><code>carb</code></td>
<td><strong>Nombre de carburateurs</strong></td>
<td>Quantitative discrète</td>
</tr>
<tr class="even">
<td><code>Y</code></td>
<td><strong>Variable cible</strong> : copie de <code>mpg</code> pour la modélisation</td>
<td>Identique à <code>mpg</code></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="remarques" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="remarques"><span class="header-section-number">1.5</span> Remarques</h2>
<ul>
<li><code>mpg</code> a été dupliquée en <code>Y</code> pour faciliter les analyses de type <strong>régression</strong>.</li>
<li>Le dataset ne contient <strong>aucune valeur manquante</strong>, ce qui le rend directement exploitable.</li>
<li>Certaines variables (<code>vs</code>, <code>am</code>) sont codées en <strong>facteurs binaires</strong> bien que numériques.</li>
<li>Les variables comme <code>gear</code>, <code>carb</code>, <code>cyl</code> sont numériques mais peuvent être traitées comme <strong>catégorielles ordonnées</strong> selon le contexte de l’analyse.</li>
</ul>
</section>
<section id="la-matrice-des-corrélation" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="la-matrice-des-corrélation"><span class="header-section-number">1.6</span> La matrice des corrélation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de corrélation (sur les variables numériques uniquement)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>vars_numeric <span class="ot">&lt;-</span> <span class="fu">select_if</span>(donnees, is.numeric)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On exclut 'Y' pour éviter la redondance</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>vars_cor <span class="ot">&lt;-</span> vars_numeric[, <span class="sc">!</span><span class="fu">names</span>(vars_numeric) <span class="sc">%in%</span> <span class="st">"Y"</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de la matrice de corrélation</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ggcorrplot<span class="sc">::</span><span class="fu">ggcorrplot</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(vars_cor),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">hc.order =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab_size =</span> <span class="dv">3</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Matrice de Corrélation"</span>) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage du graphique</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution des variables numériques avec courbe de densité</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plots_dist <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(vars_numeric), <span class="cf">function</span>(x) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(donnees, <span class="fu">aes_string</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Distribution de"</span>, x), <span class="at">x =</span> x, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_elegant</span>()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots_dist[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interprétation-des-distributions-des-variables" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="interprétation-des-distributions-des-variables"><span class="header-section-number">1.7</span> Interprétation des distributions des variables</h2>
<p>Les histogrammes avec courbe de densité permettent de visualiser la répartition des valeurs de chaque variable numérique. Voici les principales observations :</p>
<ul>
<li><p><strong>mpg (miles per gallon)</strong><br>
La distribution est légèrement asymétrique à gauche. La majorité des voitures ont une consommation comprise entre 15 et 25 mpg. Peu de modèles sont très économes (&gt;30 mpg). Cette distribution reste proche de la normale, ce qui est favorable pour une régression linéaire, mais une vérification plus poussée pourrait être utile.</p></li>
<li><p><strong>cyl (nombre de cylindres)</strong><br>
Variable clairement discrète avec trois valeurs dominantes : 4, 6 et 8. Cela montre que <code>cyl</code> doit être considérée comme une variable catégorielle, et non comme une variable continue.</p></li>
<li><p><strong>disp (cylindrée)</strong><br>
Distribution asymétrique à droite. Les valeurs sont concentrées entre 100 et 300, avec quelques cylindrées très élevées. Cette asymétrie pourrait justifier une transformation (logarithmique par exemple) avant modélisation.</p></li>
<li><p><strong>hp (puissance du moteur)</strong><br>
Là encore, une forte asymétrie à droite est visible. La plupart des voitures ont une puissance entre 80 et 180 chevaux, mais quelques valeurs extrêmes sont présentes. Une transformation peut aider à stabiliser la variance si cette variable est utilisée comme prédicteur.</p></li>
</ul>
<section id="implications-pour-la-modélisation" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="implications-pour-la-modélisation"><span class="header-section-number">1.7.1</span> Implications pour la modélisation</h3>
<ul>
<li>Les asymétries dans les variables comme <code>disp</code> et <code>hp</code> peuvent affecter les performances des modèles linéaires. Des transformations peuvent être envisagées pour améliorer les ajustements.</li>
<li>Des variables comme <code>cyl</code> doivent être traitées comme catégorielles. Cela évite d’introduire une relation linéaire artificielle avec la variable cible.</li>
<li>Cette étape permet également de repérer des valeurs atypiques ou extrêmes, qui peuvent avoir un impact important sur les coefficients si elles ne sont pas traitées.</li>
</ul>
<p>Ces constats orientent la préparation des données avant toute modélisation statistique ou machine learning.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables catégorielles</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>vars_cat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cyl"</span>, <span class="st">"am"</span>, <span class="st">"gear"</span>, <span class="st">"vs"</span>, <span class="st">"carb"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération des boxplots sans modifier le jeu de données</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plots_box <span class="ot">&lt;-</span> <span class="fu">lapply</span>(vars_cat, <span class="cf">function</span>(var) {</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(donnees, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(.data[[var]]), <span class="at">y =</span> mpg, <span class="at">fill =</span> <span class="fu">factor</span>(.data[[var]]))) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Boxplot de mpg selon"</span>, var),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> var, <span class="at">y =</span> <span class="st">"mpg"</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(grid.arrange, <span class="fu">c</span>(plots_box, <span class="at">ncol =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analyse-des-boxplots" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="analyse-des-boxplots"><span class="header-section-number">1.7.2</span> Analyse des boxplots</h3>
<p>Les boxplots permettent de visualiser l’impact des variables catégorielles sur la consommation de carburant (<code>mpg</code>). Voici les principaux enseignements :</p>
<ul>
<li><strong>cyl</strong> : plus le nombre de cylindres est élevé, plus la consommation est importante (mpg plus faible). Cette variable montre une relation claire avec la cible.</li>
<li><strong>am</strong> : les voitures à transmission manuelle (<code>am = 1</code>) sont en moyenne plus économes que celles à transmission automatique.</li>
<li><strong>gear</strong> : tendance modérée à la hausse du <code>mpg</code> avec le nombre de vitesses, mais les groupes sont déséquilibrés.</li>
<li><strong>vs</strong> : les moteurs en ligne (<code>vs = 1</code>) sont associés à une meilleure consommation que les moteurs en V.</li>
<li><strong>carb</strong> : aucune relation évidente avec <code>mpg</code>, forte dispersion selon les catégories. Les groupes avec 4, 6 ou 8 carburateurs sont très peu représentés.</li>
</ul>
<p>Les variables <code>cyl</code>, <code>am</code> et <code>vs</code> présentent des différences nettes de consommation entre groupes. Elles semblent pertinentes pour une modélisation explicative. D’autres variables comme <code>gear</code> et <code>carb</code> devront être utilisées avec prudence, en tenant compte de la taille des sous-groupes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots_dist[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analyse-des-distributions" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="analyse-des-distributions"><span class="header-section-number">1.8</span> Analyse des distributions</h2>
<p>Les graphiques de densité permettent de mieux comprendre la répartition de certaines variables explicatives du dataset <code>mtcars</code>.</p>
<ul>
<li><p><strong>drat (rear axle ratio)</strong><br>
La variable présente une distribution assez étalée avec deux pics (vers 3.1 et 3.9). Cela suggère une certaine <strong>hétérogénéité</strong> technique dans les rapports de pont des véhicules. La distribution est peu asymétrique, ce qui est favorable pour une modélisation sans transformation.</p></li>
<li><p><strong>wt (poids de la voiture, en milliers de livres)</strong><br>
La distribution est <strong>asymétrique à droite</strong> avec une concentration entre 2.5 et 3.5. Ce type de répartition est courant pour des données physiques comme le poids. Une transformation logarithmique pourrait être envisagée si le modèle est sensible à l’échelle.</p></li>
<li><p><strong>qsec (temps pour parcourir 1/4 de mile en secondes)</strong><br>
Distribution relativement symétrique avec un pic autour de 17 secondes. Cette variable semble adaptée à une modélisation directe, sans transformation.</p></li>
<li><p><strong>vs (type de moteur : 0 = V, 1 = en ligne)</strong><br>
Variable binaire avec deux groupes équilibrés. Ce type de variable doit être traité comme un <strong>facteur</strong> dans les analyses. Sa distribution en bâtons confirme sa nature catégorielle.</p></li>
</ul>
<p>Les variables <code>wt</code>, <code>drat</code> et <code>qsec</code> présentent des formes exploitables pour une modélisation. On note toutefois une légère asymétrie pour <code>wt</code>, à surveiller selon les méthodes utilisées. La variable <code>vs</code> est clairement binaire et doit être manipulée comme une variable catégorielle dans les modèles.</p>
</section>
<section id="modelisation" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="modelisation"><span class="header-section-number">1.9</span> Modelisation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Modélisation</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>modele_complet <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> . <span class="sc">-</span>mpg, <span class="at">data =</span> donnees)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>summary_complet <span class="ot">&lt;-</span> <span class="fu">summary</span>(modele_complet)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== MODÈLE COMPLET ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== MODÈLE COMPLET ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² ajusté:"</span>, <span class="fu">round</span>(summary_complet<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R² ajusté: 0.8066 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"F-statistique:"</span>, <span class="fu">round</span>(summary_complet<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"| p-value:"</span>, <span class="fu">format.pval</span>(<span class="fu">pf</span>(summary_complet<span class="sc">$</span>fstatistic[<span class="dv">1</span>], </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                                 summary_complet<span class="sc">$</span>fstatistic[<span class="dv">2</span>], </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                                 summary_complet<span class="sc">$</span>fstatistic[<span class="dv">3</span>], </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>F-statistique: 13.93 | p-value: 0.00000037932 </code></pre>
</div>
</div>
<section id="qualité-globale-du-modèle" class="level4" data-number="1.9.0.1">
<h4 data-number="1.9.0.1" class="anchored" data-anchor-id="qualité-globale-du-modèle"><span class="header-section-number">1.9.0.1</span> Qualité globale du modèle</h4>
<p>Bien que le modèle complet présente un bon R² ajusté (0.779) et une F-statistique significative, cela ne garantit pas que toutes les variables explicatives sont utiles individuellement.</p>
<p>Afin de permettre une <strong>meilleure capacité de prévision</strong>, il est essentiel d’examiner la <strong>significativité statistique des coefficients individuels</strong>. En effet, inclure des variables non significatives peut :</p>
<ul>
<li><strong>complexifier inutilement</strong> le modèle,</li>
<li><strong>introduire du bruit</strong> et de l’instabilité dans les prédictions,</li>
<li>et nuire à la <strong>généralisation</strong> sur de nouvelles données.</li>
</ul>
<p>L’analyse des <strong>valeurs p</strong> associées aux coefficients permet d’identifier les variables qui ont un <strong>effet statistiquement démontré</strong> sur la variable cible <code>mpg</code>.</p>
<p>Il est donc nécessaire de poursuivre l’analyse en évaluant chaque prédicteur individuellement, et éventuellement de construire un <strong>modèle plus parcimonieux</strong>, en ne retenant que les variables significatives.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables significatives</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>coeff_pvalues <span class="ot">&lt;-</span> summary_complet<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>vars_significatives <span class="ot">&lt;-</span> <span class="fu">names</span>(coeff_pvalues)[coeff_pvalues <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> <span class="fu">names</span>(coeff_pvalues) <span class="sc">!=</span> <span class="st">"(Intercept)"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>coeff_pvalues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         cyl        disp          hp        drat          wt 
 0.51812440  0.91608738  0.46348865  0.33495531  0.63527790  0.06325215 
       qsec          vs          am        gear        carb 
 0.27394127  0.88142347  0.23398971  0.66520643  0.81217871 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variables significatives:"</span>, <span class="fu">paste</span>(vars_significatives, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Variables significatives:  </code></pre>
</div>
</div>
</section>
</section>
<section id="significativité-des-variables-seuil-5" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="significativité-des-variables-seuil-5"><span class="header-section-number">1.10</span> Significativité des variables (seuil 5 %)</h2>
<p>Aucune des variables explicatives du modèle complet n’est significative au seuil de 5 %. Cela signifie qu’aucun prédicteur, pris isolément, n’apporte une preuve statistique suffisante de son impact sur la consommation <code>mpg</code>.</p>
<p>Deux variables (<code>hp</code> et <code>wt</code>) se rapprochent d’un effet significatif (p ≈ 0.09), mais restent au-dessus du seuil.</p>
<p>Ce résultat suggère que le modèle est probablement affecté par : - une <strong>multicolinéarité</strong> entre variables, - un <strong>nombre trop élevé de variables</strong> pour un échantillon réduit (32 observations).</p>
<p>Le modèle explique bien la variabilité globale de <code>mpg</code> (R² ajusté de 77.9 %), mais la <strong>fiabilité individuelle des variables est faible</strong>.<br>
Il sera nécessaire de tester d’autres modèles plus simples ou mieux spécifiés pour améliorer la robustesse et la capacité de prévision.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Diagnostic multicolinéarité avec visualisation</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(modele_complet)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">names</span>(vif_values), <span class="at">VIF =</span> vif_values)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>p_vif <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF), <span class="at">y =</span> VIF)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">ifelse</span>(vif_df<span class="sc">$</span>VIF <span class="sc">&gt;</span> <span class="dv">5</span>, <span class="st">"#E46726"</span>, <span class="st">"steelblue"</span>), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Facteurs d'Inflation de la Variance (VIF)"</span>, </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Ligne rouge: seuil critique (VIF = 5)"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"VIF"</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_vif)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="section" class="level3" data-number="1.10.1">
<h3 data-number="1.10.1" class="anchored" data-anchor-id="section"><span class="header-section-number">1.10.1</span> </h3>
</section>
</section>
<section id="diagnostic-de-multicolinéarité" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="diagnostic-de-multicolinéarité"><span class="header-section-number">1.11</span> Diagnostic de multicolinéarité</h2>
<p>Le graphique ci-dessus présente les <strong>valeurs des facteurs d’inflation de la variance (VIF)</strong> associés à chaque variable explicative. Ces indicateurs permettent de détecter la présence de <strong>multicolinéarité</strong>, c’est-à-dire des redondances fortes entre variables.</p>
<p>Un VIF supérieur à <strong>5</strong> est généralement considéré comme critique, car il indique qu’une variable est fortement corrélée à d’autres prédicteurs, ce qui peut rendre les coefficients instables et peu interprétables.</p>
<p>Plusieurs variables dépassent ce seuil : - <code>disp</code> atteint un VIF supérieur à 20, signe d’une colinéarité très marquée. - <code>cyl</code>, <code>wt</code>, <code>hp</code> présentent également des VIF élevés (&gt;10). - <code>carb</code>, <code>qsec</code> et <code>gear</code> se situent juste au-dessus du seuil de vigilance.</p>
<p>À l’inverse, certaines variables comme <code>vs</code>, <code>am</code> et <code>drat</code> affichent des VIF inférieurs à 5, suggérant une absence de redondance problématique.</p>
<section id="enjeux-pour-la-modélisation" class="level3" data-number="1.11.1">
<h3 data-number="1.11.1" class="anchored" data-anchor-id="enjeux-pour-la-modélisation"><span class="header-section-number">1.11.1</span> Enjeux pour la modélisation</h3>
<p>Cette situation de <strong>colinéarité importante</strong> entre plusieurs variables peut fragiliser l’estimation des effets individuels et nuire à la stabilité des prévisions.<br>
Cela renforce l’intérêt d’un <strong>ajustement du modèle</strong>, soit par sélection de variables, soit via des approches pénalisées (ex. : ridge, lasso).</p>
<p>Mais avant toute simplification, il est important de vérifier que le modèle respecte bien les <strong>autres hypothèses fondamentales</strong>, notamment concernant la distribution des résidus.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Diagnostic des résidus avec graphiques élégants</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>residus <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modele_complet)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>valeurs_ajustees <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modele_complet)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>residus_std <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(modele_complet)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests statistiques</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(residus)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> <span class="fu">ncvTest</span>(modele_complet)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>dw_test <span class="ot">&lt;-</span> <span class="fu">durbinWatsonTest</span>(modele_complet)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== DIAGNOSTIC DES RÉSIDUS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== DIAGNOSTIC DES RÉSIDUS ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Normalité (Shapiro):"</span>, <span class="fu">format.pval</span>(shapiro_test<span class="sc">$</span>p.value), </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">" ✓"</span>, <span class="st">" ✗"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Normalité (Shapiro): 0.22615  ✓ </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Homoscédasticité (BP):"</span>, <span class="fu">format.pval</span>(bp_test<span class="sc">$</span>p), </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(bp_test<span class="sc">$</span>p <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">" ✓"</span>, <span class="st">" ✗"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Homoscédasticité (BP): 0.18792  ✓ </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Indépendance (DW):"</span>, <span class="fu">format.pval</span>(dw_test<span class="sc">$</span>p), </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(dw_test<span class="sc">$</span>p <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">" ✓"</span>, <span class="st">" ✗"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Indépendance (DW): 0.3  ✓ </code></pre>
</div>
</div>
</section>
</section>
<section id="visualisation-des-résidus" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="visualisation-des-résidus"><span class="header-section-number">1.12</span> Visualisation des résidus</h2>
<p>Au-delà des tests statistiques, il est essentiel d’appuyer le diagnostic du modèle par une <strong>analyse visuelle des résidus</strong>. Les graphiques suivants permettent de vérifier de manière plus intuitive la qualité de l’ajustement et la validité des hypothèses.</p>
<p>Quatre visualisations complémentaires sont produites :</p>
<ul>
<li><p><strong>Résidus vs valeurs ajustées</strong><br>
Permet de détecter une éventuelle structure dans les résidus (effets non modélisés, non-linéarités, hétéroscédasticité).</p></li>
<li><p><strong>Q-Q plot des résidus</strong><br>
Sert à évaluer si les résidus suivent une loi normale. Un bon alignement des points sur la droite théorique indique une normalité satisfaisante.</p></li>
<li><p><strong>Histogramme des résidus avec densité</strong><br>
Complète le Q-Q plot en visualisant la forme globale de la distribution des erreurs, comparée à une densité normale.</p></li>
<li><p><strong>Observé vs Prédit</strong><br>
Donne une idée de la qualité globale de l’ajustement : plus les points sont proches de la diagonale, plus le modèle prédit fidèlement les valeurs observées.</p></li>
</ul>
<p>Ces graphiques renforcent ou nuancent les résultats des tests précédents, et permettent d’identifier visuellement des pistes d’amélioration du modèle.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphiques de diagnostic </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>p_resid1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">fitted =</span> valeurs_ajustees, <span class="at">residuals =</span> residus), </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Résidus vs Valeurs Ajustées"</span>, <span class="at">x =</span> <span class="st">"Valeurs ajustées"</span>, <span class="at">y =</span> <span class="st">"Résidus"</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>p_qq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">residuals =</span> residus), <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q Plot des Résidus"</span>, <span class="at">x =</span> <span class="st">"Quantiles théoriques"</span>, <span class="at">y =</span> <span class="st">"Quantiles observés"</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>p_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">residuals =</span> residus), <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sd</span>(residus)), </span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Résidus"</span>, <span class="at">x =</span> <span class="st">"Résidus"</span>, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>p_obs_pred <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">observed =</span> donnees<span class="sc">$</span>Y, <span class="at">predicted =</span> valeurs_ajustees), </span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observé vs Prédit"</span>, </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"R² ="</span>, <span class="fu">round</span>(summary_complet<span class="sc">$</span>r.squared, <span class="dv">3</span>)),</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valeurs observées"</span>, <span class="at">y =</span> <span class="st">"Valeurs prédites"</span>) <span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p_resid1, p_qq, p_hist, p_obs_pred, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="visualisation-des-résidus-1" class="level3" data-number="1.12.1">
<h3 data-number="1.12.1" class="anchored" data-anchor-id="visualisation-des-résidus-1"><span class="header-section-number">1.12.1</span> Visualisation des résidus</h3>
<p>Les tests statistiques réalisés précédemment ont permis de valider les hypothèses globales du modèle (normalité, homoscédasticité), à l’exception d’un doute sur l’indépendance des erreurs.<br>
Pour compléter ces diagnostics, plusieurs <strong>graphiques exploratoires</strong> sont produits afin de visualiser directement le comportement des résidus.</p>
<section id="résidus-vs-valeurs-ajustées" class="level4" data-number="1.12.1.1">
<h4 data-number="1.12.1.1" class="anchored" data-anchor-id="résidus-vs-valeurs-ajustées"><span class="header-section-number">1.12.1.1</span> Résidus vs Valeurs ajustées</h4>
<p>La courbe de tendance révèle une forme légèrement incurvée, indiquant une possible <strong>non-linéarité résiduelle</strong> ou un effet non capté par le modèle.<br>
Les résidus ne sont pas totalement aléatoires autour de zéro, ce qui suggère qu’une partie de la structure des données reste inexpliquée.</p>
</section>
<section id="q-q-plot-des-résidus" class="level4" data-number="1.12.1.2">
<h4 data-number="1.12.1.2" class="anchored" data-anchor-id="q-q-plot-des-résidus"><span class="header-section-number">1.12.1.2</span> Q-Q Plot des résidus</h4>
<p>Les points sont globalement bien alignés sur la droite théorique, avec quelques écarts aux extrémités.<br>
Cela confirme une <strong>normalité raisonnable</strong> des résidus, malgré quelques observations atypiques.</p>
</section>
<section id="distribution-des-résidus" class="level4" data-number="1.12.1.3">
<h4 data-number="1.12.1.3" class="anchored" data-anchor-id="distribution-des-résidus"><span class="header-section-number">1.12.1.3</span> Distribution des résidus</h4>
<p>L’histogramme montre une distribution relativement symétrique, avec une densité légèrement plus aplatie que la courbe normale de référence.<br>
La normalité est globalement respectée, mais on note une <strong>légère sous-dispersion</strong>.</p>
</section>
<section id="observé-vs-prédit" class="level4" data-number="1.12.1.4">
<h4 data-number="1.12.1.4" class="anchored" data-anchor-id="observé-vs-prédit"><span class="header-section-number">1.12.1.4</span> Observé vs Prédit</h4>
<p>Les valeurs prédites suivent bien la diagonale, avec un <strong>R² de 0.869</strong>, signe d’un ajustement satisfaisant dans l’ensemble.<br>
Toutefois, quelques points s’écartent de la tendance, ce qui reflète les limites du modèle complet.</p>
<p>Le diagnostic visuel confirme que le modèle capte bien la tendance générale, mais <strong>la présence de courbure dans les résidus</strong> et <strong>l’instabilité liée à la multicolinéarité</strong> justifient l’exploration de modèles alternatifs.<br>
C’est dans ce cadre qu’on doit proceder à <strong>la sélection de variables</strong>, à travers des approches classiques et régularisées.</p>
</section>
</section>
</section>
<section id="modèles" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="modèles"><span class="header-section-number">1.13</span> Modèles</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Sélection de variables</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>model_null <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> donnees)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>model_forward <span class="ot">&lt;-</span> <span class="fu">step</span>(model_null, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> model_null, <span class="at">upper =</span> modele_complet),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>model_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>model_stepwise <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>model_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>model_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">k =</span> <span class="fu">log</span>(<span class="fu">nrow</span>(donnees)), <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># LASSO avec visualisation du chemin</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>x_matrix <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Y <span class="sc">~</span> . <span class="sc">-</span>mpg, <span class="at">data =</span> donnees)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>y_vector <span class="ot">&lt;-</span> donnees<span class="sc">$</span>Y</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>cv_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_matrix, y_vector, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>model_lasso_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>vars_lasso <span class="ot">&lt;-</span> <span class="fu">rownames</span>(model_lasso_coef)[<span class="fu">which</span>(model_lasso_coef <span class="sc">!=</span> <span class="dv">0</span>)][<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique LASSO élégant</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>lasso_fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_matrix, y_vector, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda =</span> lasso_fit<span class="sc">$</span>lambda,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">dev_ratio =</span> lasso_fit<span class="sc">$</span>dev.ratio</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>p_lasso <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(lambda), <span class="at">y =</span> dev_ratio)) <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">log</span>(cv_lasso<span class="sc">$</span>lambda.min), <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">log</span>(cv_lasso<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Régularisation LASSO"</span>, </span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Lignes: λ min (bleu) et λ 1SE (vert)"</span>,</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"log(λ)"</span>, <span class="at">y =</span> <span class="st">"Proportion de déviance expliquée"</span>) <span class="sc">+</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_lasso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sélection-de-variables-et-critères-dinformation" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="sélection-de-variables-et-critères-dinformation"><span class="header-section-number">1.14</span> Sélection de variables et critères d’information</h2>
<p>Pour simplifier le modèle tout en maintenant sa capacité explicative, plusieurs méthodes de sélection ont été appliquées. Elles reposent sur l’optimisation de critères d’information, qui mesurent le compromis entre <strong>qualité d’ajustement</strong> et <strong>complexité du modèle</strong>.</p>
<section id="formules-des-critères-dinformation" class="level4" data-number="1.14.0.1">
<h4 data-number="1.14.0.1" class="anchored" data-anchor-id="formules-des-critères-dinformation"><span class="header-section-number">1.14.0.1</span> Formules des critères d’information</h4>
<ul>
<li><p><strong>AIC (Akaike Information Criterion)</strong><br>
<span class="math display">\[ \text{AIC} = -2 \log(\mathcal{L}) + 2k \]</span></p></li>
<li><p><strong>BIC (Bayesian Information Criterion)</strong><br>
<span class="math display">\[ \text{BIC} = -2 \log(\mathcal{L}) + k \log(n) \]</span></p></li>
</ul>
<p>où :</p>
<p><span class="math display">\[\log(\mathcal{L})\]</span> est le log-vraisemblance du modèle, <span class="math display">\[k\]</span> est le nombre de paramètres estimés, <span class="math display">\[n\]</span> est le nombre d’observations.</p>
</section>
<section id="interprétation" class="level4" data-number="1.14.0.2">
<h4 data-number="1.14.0.2" class="anchored" data-anchor-id="interprétation"><span class="header-section-number">1.14.0.2</span> Interprétation</h4>
<ul>
<li>Ces critères pénalisent les modèles trop complexes : plus (<span class="math display">\[k\]</span>) est élevé, plus la pénalité est forte.</li>
<li><strong>AIC</strong> favorise généralement les modèles explicatifs (moins pénalisant).</li>
<li><strong>BIC</strong> est plus conservateur, il privilégie les modèles <strong>plus simples</strong> si la taille de l’échantillon est petite ou moyenne.</li>
</ul>
</section>
<section id="implication" class="level4" data-number="1.14.0.3">
<h4 data-number="1.14.0.3" class="anchored" data-anchor-id="implication"><span class="header-section-number">1.14.0.3</span> Implication</h4>
<p>Minimiser l’AIC ou le BIC revient à <strong>trouver le meilleur compromis entre ajustement et parcimonie</strong>.<br>
Dans ce contexte : - AIC est utile pour un <strong>modèle prédictif performant</strong>. - BIC est préférable si l’objectif est <strong>l’interprétation claire et robuste</strong> du modèle.</p>
<p>Ces approches sont complémentaires de la régularisation LASSO, qui sélectionne automatiquement les variables les plus contributives tout en réduisant le risque de surajustement.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== SÉLECTION DE VARIABLES ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== SÉLECTION DE VARIABLES ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Forward  :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_forward))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Forward  : wt, cyl, hp </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Backward :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_backward))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Backward : wt, qsec, am </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Stepwise :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_stepwise))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise : wt, qsec, am </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC      :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_aic))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AIC      : wt, qsec, am </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC      :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_bic))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BIC      : wt, qsec, am </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"LASSO    :"</span>, <span class="fu">paste</span>(vars_lasso, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>LASSO    : cyl, hp, drat, wt, am, carb </code></pre>
</div>
</div>
</section>
<section id="sélection-de-variables" class="level3" data-number="1.14.1">
<h3 data-number="1.14.1" class="anchored" data-anchor-id="sélection-de-variables"><span class="header-section-number">1.14.1</span> Sélection de variables</h3>
<p>Différentes méthodes de sélection ont été appliquées (stepwise, AIC, BIC, LASSO) afin d’identifier un sous-ensemble optimal de variables explicatives pour modéliser <code>mpg</code>.</p>
<section id="points-de-convergence" class="level4" data-number="1.14.1.1">
<h4 data-number="1.14.1.1" class="anchored" data-anchor-id="points-de-convergence"><span class="header-section-number">1.14.1.1</span> Points de convergence</h4>
<ul>
<li>La variable <strong><code>wt</code></strong> (poids du véhicule) est sélectionnée <strong>par toutes les méthodes</strong>, confirmant son rôle déterminant dans la consommation.</li>
<li>Les approches <strong>AIC</strong>, <strong>BIC</strong>, <strong>stepwise</strong> et <strong>backward</strong> aboutissent exactement au même trio de variables : <code>wt</code>, <code>qsec</code> et <code>am</code>.<br>
→ Ce modèle est <strong>court, cohérent</strong>, et respecte les critères de parcimonie tout en conservant une bonne qualité d’ajustement.</li>
</ul>
</section>
<section id="apports-spécifiques" class="level4" data-number="1.14.1.2">
<h4 data-number="1.14.1.2" class="anchored" data-anchor-id="apports-spécifiques"><span class="header-section-number">1.14.1.2</span> Apports spécifiques</h4>
<ul>
<li><strong>LASSO</strong> identifie un modèle plus large, incluant <code>wt</code>, <code>cyl</code>, <code>hp</code>, <code>am</code> et <code>carb</code>.<br>
Cela reflète une stratégie orientée vers la <strong>performance prédictive</strong>, en retenant des variables partiellement redondantes mais contributives.</li>
<li><strong>Forward selection</strong> (ajout progressif) retient <code>wt</code>, <code>cyl</code>, <code>hp</code> — ce qui rejoint partiellement LASSO — mais ignore <code>am</code> et <code>qsec</code>.</li>
</ul>
</section>
<section id="interprétation-1" class="level4" data-number="1.14.1.3">
<h4 data-number="1.14.1.3" class="anchored" data-anchor-id="interprétation-1"><span class="header-section-number">1.14.1.3</span> Interprétation</h4>
<ul>
<li>Le fait que <code>cyl</code>, <code>hp</code> et <code>carb</code> soient <strong>retenues par LASSO mais écartées par BIC</strong> montre qu’elles contiennent de l’information, mais au prix d’une plus grande complexité.</li>
<li><strong><code>qsec</code></strong> (temps sur un quart de mile) est conservée uniquement par les approches classiques, probablement car elle capte une part de variance résiduelle non prise en compte par les variables moteur.</li>
</ul>
</section>
</section>
<section id="implication-1" class="level3" data-number="1.14.2">
<h3 data-number="1.14.2" class="anchored" data-anchor-id="implication-1"><span class="header-section-number">1.14.2</span> Implication</h3>
<p>Deux stratégies sont envisageables : - <strong>Modèle parsimonieux</strong> : <code>wt</code>, <code>qsec</code>, <code>am</code> → stable, simple à interpréter, adapté à l’explication. - <strong>Modèle régularisé</strong> : <code>wt</code>, <code>cyl</code>, <code>hp</code>, <code>am</code>, <code>carb</code> → potentiellement plus performant en prédiction, mais moins lisible.</p>
<p>La prochaine étape consistera à <strong>comparer ces modèles</strong> sur la base de leur performance (R² ajusté, AIC, etc.) et de la qualité des résidus.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Comparaison des modèles avec visualisation</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>models_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Complet"</span> <span class="ot">=</span> modele_complet,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Forward"</span> <span class="ot">=</span> model_forward,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Backward"</span> <span class="ot">=</span> model_backward,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Stepwise"</span> <span class="ot">=</span> model_stepwise,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AIC"</span> <span class="ot">=</span> model_aic,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BIC"</span> <span class="ot">=</span> model_bic</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modele =</span> <span class="fu">names</span>(models_list),</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_Vars =</span> <span class="fu">sapply</span>(models_list, <span class="cf">function</span>(m) <span class="fu">length</span>(<span class="fu">coef</span>(m)) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_Adj =</span> <span class="fu">sapply</span>(models_list, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">sapply</span>(models_list, AIC),</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC =</span> <span class="fu">sapply</span>(models_list, BIC),</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">sapply</span>(models_list, <span class="cf">function</span>(m) <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(m)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> comparison[<span class="fu">order</span>(comparison<span class="sc">$</span>R2_Adj, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>comparison[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(comparison[, <span class="sc">-</span><span class="dv">1</span>], <span class="dv">4</span>)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique de comparaison </span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>comp_long <span class="ot">&lt;-</span> comparison <span class="sc">%&gt;%</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Modele, R2_Adj, AIC, BIC, RMSE) <span class="sc">%&gt;%</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Modele, <span class="at">names_to =</span> <span class="st">"Metric"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>p_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comp_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Modele, <span class="fu">ifelse</span>(Metric <span class="sc">==</span> <span class="st">"R2_Adj"</span>, Value, <span class="sc">-</span>Value)), </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> Value, <span class="at">fill =</span> Modele)) <span class="sc">+</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Metric, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparaison des Modèles"</span>, <span class="at">x =</span> <span class="st">"Modèle"</span>, <span class="at">y =</span> <span class="st">"Valeur"</span>) <span class="sc">+</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Modele N_Vars R2_Adj      AIC      BIC   RMSE
Backward Backward      3 0.8336 154.1194 161.4481 2.3000
Stepwise Stepwise      3 0.8336 154.1194 161.4481 2.3000
AIC           AIC      3 0.8336 154.1194 161.4481 2.3000
BIC           BIC      3 0.8336 154.1194 161.4481 2.3000
Forward   Forward      3 0.8263 155.4766 162.8053 2.3493
Complet   Complet     10 0.8066 163.7098 181.2986 2.1469</code></pre>
</div>
</div>
</section>
</section>
<section id="comparaison-des-modèles-sélectionnés" class="level2" data-number="1.15">
<h2 data-number="1.15" class="anchored" data-anchor-id="comparaison-des-modèles-sélectionnés"><span class="header-section-number">1.15</span> Comparaison des modèles sélectionnés</h2>
<p>Les modèles issus des différentes méthodes de sélection ont été évalués selon quatre critères complémentaires :</p>
<ul>
<li><strong>R² ajusté</strong> : mesure la proportion de variance expliquée en tenant compte du nombre de variables.</li>
<li><strong>AIC</strong> et <strong>BIC</strong> : critères d’information pénalisant la complexité du modèle.</li>
<li><strong>RMSE</strong> (Root Mean Squared Error) : mesure l’erreur moyenne de prédiction.</li>
</ul>
<section id="résultats-observés" class="level4" data-number="1.15.0.1">
<h4 data-number="1.15.0.1" class="anchored" data-anchor-id="résultats-observés"><span class="header-section-number">1.15.0.1</span> Résultats observés</h4>
<ul>
<li>Les modèles issus de <strong>stepwise</strong>, <strong>backward</strong>, <strong>AIC</strong> et <strong>BIC</strong> sont <strong>strictement équivalents</strong> : même nombre de variables (3), même R² ajusté (≈ 0.8336), AIC et BIC minimaux, RMSE identique (2.30).</li>
<li>Le modèle <strong>forward</strong> est légèrement moins performant (R² ≈ 0.826), avec une erreur de prédiction un peu plus élevée (RMSE = 2.35).</li>
<li>Le <strong>modèle complet</strong>, bien qu’ayant le R² le plus élevé, est <strong>pénalisé par sa complexité</strong> : AIC, BIC et RMSE sont moins favorables.</li>
</ul>
</section>
<section id="interprétation-2" class="level4" data-number="1.15.0.2">
<h4 data-number="1.15.0.2" class="anchored" data-anchor-id="interprétation-2"><span class="header-section-number">1.15.0.2</span> Interprétation</h4>
<p>→ Le <strong>modèle retenu</strong> est donc celui sélectionné par <strong>BIC / AIC / backward / stepwise</strong> : il maximise l’efficacité explicative tout en restant simple et interprétable (<code>wt</code>, <code>qsec</code>, <code>am</code>).</p>
<hr>
</section>
<section id="étape-suivante-validation-croisée-loocv" class="level3" data-number="1.15.1">
<h3 data-number="1.15.1" class="anchored" data-anchor-id="étape-suivante-validation-croisée-loocv"><span class="header-section-number">1.15.1</span> Étape suivante : validation croisée (LOOCV)</h3>
<p>Pour évaluer la <strong>robustesse du modèle retenu</strong> et sa capacité à bien généraliser hors échantillon, une <strong>validation croisée Leave-One-Out</strong> (LOOCV) est réalisée.</p>
<p>Cette méthode consiste à : - entraîner le modèle sur <em>n-1</em> observations, - tester sa prédiction sur la <em>nième</em>, - répéter l’opération pour chaque observation.</p>
<p>Elle permet d’obtenir une <strong>estimation credible de l’erreur de prédiction</strong> (RMSE CV), ainsi qu’un R² croisé qui reflète la stabilité du modèle sur des données nouvelles.</p>
<p>La prochaine visualisation mettra en regard les valeurs observées et les valeurs prédites par validation croisée.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === 8. Modèle final et validation croisée (LOOCV) ===</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Sélection du meilleur modèle (le 1er dans le tableau de comparaison)</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>best_model_name <span class="ot">&lt;-</span> comparison<span class="sc">$</span>Modele[<span class="dv">1</span>]</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> models_list[[best_model_name]]</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Validation croisée Leave-One-Out (LOOCV)</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(donnees)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>predictions_loo <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  model_cv <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">formula</span>(final_model), <span class="at">data =</span> donnees[<span class="sc">-</span>i, ])</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  predictions_loo[i] <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_cv, <span class="at">newdata =</span> donnees[i, ])</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Évaluation des performances en validation croisée</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>residuals_loo <span class="ot">&lt;-</span> donnees<span class="sc">$</span>Y <span class="sc">-</span> predictions_loo</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>r2_cv <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(residuals_loo<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((donnees<span class="sc">$</span>Y <span class="sc">-</span> <span class="fu">mean</span>(donnees<span class="sc">$</span>Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>rmse_cv <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(residuals_loo<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Préparation des données pour la visualisation</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>cv_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed =</span> donnees<span class="sc">$</span>Y,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted_Model =</span> <span class="fu">fitted</span>(final_model),</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted_CV =</span> predictions_loo</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Affichage des scores</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== VALIDATION CROISÉE (LOOCV) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=== VALIDATION CROISÉE (LOOCV) ===</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (CV)   :"</span>, <span class="fu">round</span>(r2_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R² (CV)   : 0.7946 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE (CV) :"</span>, <span class="fu">round</span>(rmse_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE (CV) : 2.6885 </code></pre>
</div>
</div>
</section>
</section>
<section id="validation-croisée-loocv" class="level2" data-number="1.16">
<h2 data-number="1.16" class="anchored" data-anchor-id="validation-croisée-loocv"><span class="header-section-number">1.16</span> Validation croisée (LOOCV)</h2>
<p>Pour évaluer la <strong>robustesse prédictive</strong> du modèle sélectionné, une validation croisée Leave-One-Out (LOOCV) a été réalisée. Cette méthode consiste à entraîner le modèle sur <em>n-1</em> observations, puis à tester la prédiction sur la nième, et ainsi de suite pour l’ensemble des données.</p>
<section id="résultats-obtenus" class="level4" data-number="1.16.0.1">
<h4 data-number="1.16.0.1" class="anchored" data-anchor-id="résultats-obtenus"><span class="header-section-number">1.16.0.1</span> Résultats obtenus</h4>
<ul>
<li><p><strong>R² croisé</strong> : 0.7946<br>
→ Le modèle parvient à expliquer près de <strong>79,5 %</strong> de la variance des données sur des observations non vues à l’entraînement.</p></li>
<li><p><strong>RMSE croisé</strong> : 2.6885<br>
→ L’erreur quadratique moyenne sur des prédictions en dehors de l’échantillon est <strong>raisonnable et stable</strong>, proche de celle du modèle initial.</p></li>
</ul>
</section>
<section id="interprétation-3" class="level4" data-number="1.16.0.2">
<h4 data-number="1.16.0.2" class="anchored" data-anchor-id="interprétation-3"><span class="header-section-number">1.16.0.2</span> Interprétation</h4>
<ul>
<li>Le <strong>R² CV est légèrement inférieur</strong> au R² ajusté du modèle complet (~0.83), ce qui est attendu car le LOOCV pénalise toute forme de surajustement.</li>
<li>L’écart modéré entre les deux scores confirme que le modèle est <strong>généralisable</strong> et ne dépend pas excessivement de données particulières.</li>
<li>Le <strong>RMSE de validation croisée</strong> reste contenu, ce qui traduit une <strong>erreur de prédiction cohérente et stable</strong> sur l’ensemble du jeu de données.</li>
</ul>
</section>
<section id="on-observe" class="level3" data-number="1.16.1">
<h3 data-number="1.16.1" class="anchored" data-anchor-id="on-observe"><span class="header-section-number">1.16.1</span> On observe:</h3>
<p>Le modèle sélectionné (<code>wt</code>, <code>qsec</code>, <code>am</code>) montre une <strong>bonne capacité de généralisation</strong>, tout en conservant un <strong>nombre limité de variables</strong>.<br>
La validation croisée confirme la solidité du choix effectué sur des critères théoriques (AIC/BIC) et empiriques (graphes, résidus, performances).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>p_cv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cv_data, <span class="fu">aes</span>(<span class="at">x =</span> Observed)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Predicted_Model, <span class="at">color =</span> <span class="st">"Ajustement"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Predicted_CV, <span class="at">color =</span> <span class="st">"Validation croisée"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Ajustement"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"Validation croisée"</span> <span class="ot">=</span> <span class="st">"#E46726"</span>)) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Validation Croisée vs Ajustement"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"R² CV ="</span>, <span class="fu">round</span>(r2_cv, <span class="dv">3</span>), <span class="st">"| R² Ajust ="</span>, <span class="fu">round</span>(<span class="fu">summary</span>(final_model)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>)),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valeurs observées"</span>, <span class="at">y =</span> <span class="st">"Valeurs prédites"</span>, <span class="at">color =</span> <span class="st">"Type"</span>) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_cv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="résumé-de-la-validation-croisée" class="level3" data-number="1.16.2">
<h3 data-number="1.16.2" class="anchored" data-anchor-id="résumé-de-la-validation-croisée"><span class="header-section-number">1.16.2</span> Résumé de la validation croisée</h3>
<p>Le graphique compare les valeurs observées à deux types de prédictions :</p>
<ul>
<li>Les prédictions issues du <strong>modèle ajusté sur l’ensemble des données</strong> (<code>Ajustement</code>)</li>
<li>Les prédictions obtenues par <strong>validation croisée Leave-One-Out</strong> (<code>Validation croisée</code>)</li>
</ul>
<section id="lecture-des-résultats" class="level4" data-number="1.16.2.1">
<h4 data-number="1.16.2.1" class="anchored" data-anchor-id="lecture-des-résultats"><span class="header-section-number">1.16.2.1</span> Lecture des résultats</h4>
<ul>
<li>Les deux nuages de points sont globalement <strong>alignés sur la diagonale</strong>, ce qui indique une bonne cohérence entre les prédictions et les observations.</li>
<li>Les points de validation croisée (orange) sont <strong>légèrement plus dispersés</strong> autour de la diagonale que ceux du modèle ajusté (bleu), ce qui est normal :<br>
→ le modèle ajusté sur tout l’échantillon a un <strong>léger avantage optimiste</strong>.</li>
<li>Les écarts entre les deux restent modérés, ce qui confirme une <strong>stabilité du modèle</strong>.</li>
</ul>
</section>
<section id="résumé-des-scores" class="level4" data-number="1.16.2.2">
<h4 data-number="1.16.2.2" class="anchored" data-anchor-id="résumé-des-scores"><span class="header-section-number">1.16.2.2</span> Résumé des scores</h4>
<ul>
<li><p><strong>R² ajusté</strong> : 0.834<br>
→ Mesure la qualité d’ajustement sur l’échantillon complet.</p></li>
<li><p><strong>R² croisé</strong> : 0.795<br>
→ Estimation plus réaliste de la capacité du modèle à prédire sur de nouvelles données.</p></li>
</ul>
<p>L’écart modéré entre les deux R² montre que le modèle ne souffre <strong>ni de surajustement, ni de sous-ajustement</strong>.<br>
La validation croisée confirme que le modèle retenu est <strong>robuste, prédictif et généralisable</strong>, en plus d’être simple et interprétable.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Importance des variables</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">coef</span>(final_model)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coefficients standardisés</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  predictors <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">coef</span>(final_model))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  X_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(donnees[, predictors, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  y_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(donnees<span class="sc">$</span>Y)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  model_std <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_std <span class="sc">~</span> X_std)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  coef_std <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_std)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  importance_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">names</span>(coef_std),</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coef_Std =</span> coef_std,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">abs</span>(coef_std)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Importance)) <span class="sc">%&gt;%</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Importance_Pct =</span> Importance <span class="sc">/</span> <span class="fu">sum</span>(Importance) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Graphique d'importance élégant</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  p_imp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(importance_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variable, Importance_Pct), <span class="at">y =</span> Importance_Pct)) <span class="sc">+</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Importance_Pct, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Importance des Variables"</span>, </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Basée sur les coefficients standardisés"</span>,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Importance (%)"</span>) <span class="sc">+</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_elegant</span>()</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p_imp)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_LM_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="importance-des-variables" class="level3" data-number="1.16.3">
<h3 data-number="1.16.3" class="anchored" data-anchor-id="importance-des-variables"><span class="header-section-number">1.16.3</span> Importance des variables</h3>
<p>Le graphique ci-dessus présente l’importance relative des variables explicatives du modèle final, calculée à partir des <strong>coefficients standardisés</strong>. Cette méthode permet de comparer directement l’effet de chaque variable, indépendamment de leur unité de mesure.</p>
<section id="résultats" class="level4" data-number="1.16.3.1">
<h4 data-number="1.16.3.1" class="anchored" data-anchor-id="résultats"><span class="header-section-number">1.16.3.1</span> Résultats</h4>
<ul>
<li><p><strong><code>wt</code> (poids du véhicule)</strong> est la variable la plus influente, représentant <strong>51,2 %</strong> de l’effet total du modèle.<br>
→ Cela confirme son rôle central dans la consommation de carburant (<code>mpg</code>), déjà mis en évidence par toutes les méthodes de sélection.</p></li>
<li><p><strong><code>qsec</code> (temps sur 1/4 mile)</strong> contribue à hauteur de <strong>29,3 %</strong>.<br>
→ Cette variable capte probablement des différences de performances moteur non directement expliquées par <code>hp</code>.</p></li>
<li><p><strong><code>am</code> (type de transmission)</strong> intervient pour <strong>19,6 %</strong>.<br>
→ Son influence, bien que plus modeste, reste significative, notamment sur la consommation selon le type de boîte (automatique ou manuelle).</p></li>
</ul>
</section>
<section id="interprétation-4" class="level4" data-number="1.16.3.2">
<h4 data-number="1.16.3.2" class="anchored" data-anchor-id="interprétation-4"><span class="header-section-number">1.16.3.2</span> Interprétation</h4>
<p>L’analyse montre que, même dans un modèle simple, la <strong>poids du véhicule domine clairement l’explication de la consommation</strong>, suivi par des facteurs dynamiques (<code>qsec</code>) et mécaniques (<code>am</code>).<br>
Cela confirme la <strong>pertinence du modèle retenu</strong>, à la fois explicatif, stable et interprétable.</p>
<hr>
<p>Souhaites-tu maintenant que je t’aide à rédiger une <strong>conclusion finale complète</strong> de l’analyse ? Ou un <strong>résumé global</strong> du notebook à insérer au début ou à la fin ?</p>
</section>
</section>
<section id="section-1" class="level3" data-number="1.16.4">
<h3 data-number="1.16.4" class="anchored" data-anchor-id="section-1"><span class="header-section-number">1.16.4</span> </h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Résumé final élégant</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>final_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(final_model)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">60</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"                    RÉSUMÉ FINAL</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    RÉSUMÉ FINAL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">60</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Modèle sélectionné  :"</span>, best_model_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Modèle sélectionné  : Backward </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variables retenues  :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(final_model))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Variables retenues  : wt, qsec, am </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre de variables :"</span>, <span class="fu">length</span>(<span class="fu">coef</span>(final_model))<span class="sc">-</span><span class="dv">1</span>, <span class="st">"/"</span>, <span class="fu">ncol</span>(donnees)<span class="sc">-</span><span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre de variables : 3 / 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² ajusté          :"</span>, <span class="fu">round</span>(final_summary<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R² ajusté          : 0.8336 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² validation      :"</span>, <span class="fu">round</span>(r2_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R² validation      : 0.7946 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE               :"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(final_model)<span class="sc">^</span><span class="dv">2</span>)), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE               : 2.3 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE validation    :"</span>, <span class="fu">round</span>(rmse_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE validation    : 2.6885 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC                :"</span>, <span class="fu">round</span>(<span class="fu">AIC</span>(final_model), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AIC                : 154.12 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC                :"</span>, <span class="fu">round</span>(<span class="fu">BIC</span>(final_model), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BIC                : 161.45 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance globale</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(r2_cv <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(final_summary<span class="sc">$</span>adj.r.squared <span class="sc">-</span> r2_cv) <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Qualité            : ✓ Excellent</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(r2_cv <span class="sc">&gt;</span> <span class="fl">0.6</span>) {</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Qualité            : Acceptable</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Qualité            : À améliorer</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Qualité            : Acceptable</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">60</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sauvegarde</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(final_model, <span class="st">"modele_final.rds"</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">"final_model"</span>, <span class="st">"comparison"</span>, <span class="st">"donnees"</span>, <span class="st">"importance_df"</span>), </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">"resultats_regression.RData"</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Fichiers sauvegardés: modele_final.rds, resultats_regression.RData</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Fichiers sauvegardés: modele_final.rds, resultats_regression.RData</code></pre>
</div>
</div>
</section>
</section>
<section id="et-après-que-faire-du-modèle" class="level2" data-number="1.17">
<h2 data-number="1.17" class="anchored" data-anchor-id="et-après-que-faire-du-modèle"><span class="header-section-number">1.17</span> Et après… que faire du modèle ?</h2>
<p>Une fois le modèle final validé, il peut être réutilisé dans divers contextes :<br>
<strong>prédiction</strong>, <strong>automatisation</strong>, <strong>rapport dynamique</strong>, <strong>déploiement applicatif</strong>, ou encore <strong>communication des résultats</strong>.</p>
<p>Deux méthodes de rechargement sont disponibles, selon le niveau de détail souhaité.</p>
<hr>
<section id="option-1-charger-uniquement-le-modèle-final-léger-production" class="level3" data-number="1.17.1">
<h3 data-number="1.17.1" class="anchored" data-anchor-id="option-1-charger-uniquement-le-modèle-final-léger-production"><span class="header-section-number">1.17.1</span> ✅ Option 1 — Charger uniquement le modèle final (léger, production)</h3>
<p>Cette option consiste à charger uniquement le modèle statistique (sans les autres objets d’analyse).<br>
Elle est idéale pour effectuer rapidement des <strong>prédictions sur de nouvelles données</strong>, ou pour intégrer le modèle dans un <strong>pipeline</strong>, une <strong>API</strong> ou une <strong>application (ex : Shiny)</strong>.</p>
<p><strong>Commande :</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # (utiliser cette ligne seule si tu veux juste faire des prédictions)</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># modele &lt;- readRDS("modele_final.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="option-2-recharger-lenvironnement-complet-de-lanalyse-.rdata" class="level3" data-number="1.17.2">
<h3 data-number="1.17.2" class="anchored" data-anchor-id="option-2-recharger-lenvironnement-complet-de-lanalyse-.rdata"><span class="header-section-number">1.17.2</span> Option 2 — Recharger l’environnement complet de l’analyse (<code>.RData</code>)</h3>
<p>Lorsque l’on souhaite <strong>reprendre, approfondir, enrichir ou documenter</strong> une analyse déjà réalisée, il est conseillé d’utiliser le fichier <code>.RData</code>, qui contient l’ensemble des objets de travail sauvegardés à la fin du projet.</p>
<p>Cela permet de <strong>gagner du temps</strong>, d’éviter de relancer tous les calculs, et d’assurer une <strong>traçabilité complète</strong> des étapes effectuées.</p>
<hr>
<section id="commande" class="level4" data-number="1.17.2.1">
<h4 data-number="1.17.2.1" class="anchored" data-anchor-id="commande"><span class="header-section-number">1.17.2.1</span> Commande</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>modele <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"modele_final.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="faire-une-prédiction-à-partir-de-notre-modele" class="level3" data-number="1.17.3">
<h3 data-number="1.17.3" class="anchored" data-anchor-id="faire-une-prédiction-à-partir-de-notre-modele"><span class="header-section-number">1.17.3</span> Faire une prédiction à partir de notre modele</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Créer une nouvelle observation (même structure que les données d'entraînement)</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>nouvelles_donnees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cyl   =</span> <span class="dv">6</span>,     <span class="co"># Nombre de cylindres</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">disp  =</span> <span class="dv">200</span>,   <span class="co"># Cylindrée (en pouces cubes)</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">hp    =</span> <span class="dv">150</span>,   <span class="co"># Puissance (horsepower)</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">drat  =</span> <span class="fl">3.5</span>,   <span class="co"># Rapport du pont arrière</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">wt    =</span> <span class="fl">3.2</span>,   <span class="co"># Poids (en milliers de livres)</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">qsec  =</span> <span class="dv">18</span>,    <span class="co"># Temps au quart de mile</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">vs    =</span> <span class="dv">0</span>,     <span class="co"># Type de moteur (0 = V, 1 = ligne)</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">am    =</span> <span class="dv">1</span>,     <span class="co"># Transmission (0 = auto, 1 = manuelle)</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gear  =</span> <span class="dv">4</span>,     <span class="co"># Nombre de vitesses</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">carb  =</span> <span class="dv">2</span>      <span class="co"># Nombre de carburateurs</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Prédire la consommation (mpg) pour cette observation</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele, <span class="at">newdata =</span> nouvelles_donnees)</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Afficher proprement le résultat</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prediction, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1 
22.09 </code></pre>
</div>
</div>
</section>
<section id="faire-des-prédictions-avec-le-modèle-final-si-haut" class="level3" data-number="1.17.4">
<h3 data-number="1.17.4" class="anchored" data-anchor-id="faire-des-prédictions-avec-le-modèle-final-si-haut"><span class="header-section-number">1.17.4</span> Faire des prédictions avec le modèle final (si haut)</h3>
<p>Une fois le modèle rechargé (<code>readRDS()</code> ou <code>load()</code>), il est possible d’utiliser la fonction <code>predict()</code> pour estimer la valeur cible (<code>mpg</code>) à partir de nouvelles données.</p>
<p>Le tableau ci-dessous présente les valeurs des variables explicatives pour une voiture hypothétique :</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>cyl</th>
<th>disp</th>
<th>hp</th>
<th>drat</th>
<th>wt</th>
<th>qsec</th>
<th>vs</th>
<th>am</th>
<th>gear</th>
<th>carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>200</td>
<td>150</td>
<td>3.5</td>
<td>3.2</td>
<td>18</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>2</td>
</tr>
</tbody>
</table>
<hr>
<section id="résultat-de-la-prédiction" class="level4" data-number="1.17.4.1">
<h4 data-number="1.17.4.1" class="anchored" data-anchor-id="résultat-de-la-prédiction"><span class="header-section-number">1.17.4.1</span> Résultat de la prédiction</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Observation</th>
<th>mpg prédit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>22.09</strong></td>
</tr>
</tbody>
</table>
<p>Le modèle prédit que ce véhicule aura une consommation estimée à <strong>22.09 miles par gallon</strong>.</p>
</section>
<section id="conseil" class="level4" data-number="1.17.4.2">
<h4 data-number="1.17.4.2" class="anchored" data-anchor-id="conseil"><span class="header-section-number">1.17.4.2</span> Conseil:</h4>
<ul>
<li>Les <strong>variables doivent avoir les mêmes noms et types</strong> que celles utilisées à l’entraînement.</li>
<li>On peux prédire plusieurs lignes à la fois en passant un <code>data.frame</code> avec plusieurs observations.</li>
<li>Pour des usages fréquents, il est recommandé d’encapsuler le tout dans une fonction <code>predict_mpg()</code>.</li>
</ul>
<!-- -->

</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb98" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Régression Linéaire Multiple"</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Nicodeme KONE"</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly          # thème élégant et clair</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true              # table des matières (facultatif)</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true        # permet de replier les blocs de code</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true       # ajoute bouton "Copier"</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full      # ✅ pleine largeur de l’écran</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css        # (optionnel) pour style personnalisé</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="fu"># Projet Regression Linéaire Multiple</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Installation des bibliothèques</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration initiale</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Gestion des packages avec pacman</span></span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>, <span class="at">repos =</span> <span class="st">"https://cran.rstudio.com/"</span>)</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(pacman)</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement de tous les packages nécessaires</span></span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(tidyverse, ggthemes, car, glmnet, MASS, corrplot, </span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>       gridExtra, broom, performance, GGally, viridis, </span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a>       plotly, kableExtra)</span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir theme_elegant (version optimisée)</span></span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>theme_elegant <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a>                             <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>)),</span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>                                <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">15</span>)),</span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"grey30"</span>),</span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chargement des données</span></span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Chargement et préparation des données</span></span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb98-74"><a href="#cb98-74" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> mtcars</span>
<span id="cb98-75"><a href="#cb98-75" aria-hidden="true" tabindex="-1"></a>donnees<span class="sc">$</span>Y <span class="ot">&lt;-</span> donnees<span class="sc">$</span>mpg</span>
<span id="cb98-76"><a href="#cb98-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-77"><a href="#cb98-77" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dataset:"</span>, <span class="fu">nrow</span>(donnees), <span class="st">"observations,"</span>, <span class="fu">ncol</span>(donnees)<span class="sc">-</span><span class="dv">1</span>, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-78"><a href="#cb98-78" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Valeurs manquantes:"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(donnees)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-79"><a href="#cb98-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-80"><a href="#cb98-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-81"><a href="#cb98-81" aria-hidden="true" tabindex="-1"></a><span class="fu">## Description du dataset `mtcars`</span></span>
<span id="cb98-82"><a href="#cb98-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-83"><a href="#cb98-83" aria-hidden="true" tabindex="-1"></a>Le jeu de données <span class="in">`mtcars`</span> est un dataset classique intégré à R, tiré de la publication *Motor Trend US magazine* (1974). Il fournit des caractéristiques techniques de 32 modèles de voitures (principalement américaines) des années 1970.</span>
<span id="cb98-84"><a href="#cb98-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-85"><a href="#cb98-85" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dimensions</span></span>
<span id="cb98-86"><a href="#cb98-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-87"><a href="#cb98-87" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Nombre d'observations** : 32 voitures\</span>
<span id="cb98-88"><a href="#cb98-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Nombre de variables** : 11 variables explicatives + 1 variable cible <span class="in">`Y`</span></span>
<span id="cb98-89"><a href="#cb98-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-90"><a href="#cb98-90" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb98-91"><a href="#cb98-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-92"><a href="#cb98-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Liste des variables</span></span>
<span id="cb98-93"><a href="#cb98-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-94"><a href="#cb98-94" aria-hidden="true" tabindex="-1"></a>| Variable | Description | Type |</span>
<span id="cb98-95"><a href="#cb98-95" aria-hidden="true" tabindex="-1"></a>|------------------------|------------------------|------------------------|</span>
<span id="cb98-96"><a href="#cb98-96" aria-hidden="true" tabindex="-1"></a>| <span class="in">`mpg`</span> | **Miles per gallon** : consommation de carburant (miles parcourus par gallon) | Quantitative continue (cible <span class="in">`Y`</span>) |</span>
<span id="cb98-97"><a href="#cb98-97" aria-hidden="true" tabindex="-1"></a>| <span class="in">`cyl`</span> | **Nombre de cylindres** | Quantitative discrète |</span>
<span id="cb98-98"><a href="#cb98-98" aria-hidden="true" tabindex="-1"></a>| <span class="in">`disp`</span> | **Cylindrée** (en pouces cubes) | Quantitative continue |</span>
<span id="cb98-99"><a href="#cb98-99" aria-hidden="true" tabindex="-1"></a>| <span class="in">`hp`</span> | **Puissance** du moteur (en chevaux-vapeur) | Quantitative continue |</span>
<span id="cb98-100"><a href="#cb98-100" aria-hidden="true" tabindex="-1"></a>| <span class="in">`drat`</span> | **Rapport de pont** (rear axle ratio) | Quantitative continue |</span>
<span id="cb98-101"><a href="#cb98-101" aria-hidden="true" tabindex="-1"></a>| <span class="in">`wt`</span> | **Poids de la voiture** (en milliers de livres) | Quantitative continue |</span>
<span id="cb98-102"><a href="#cb98-102" aria-hidden="true" tabindex="-1"></a>| <span class="in">`qsec`</span> | **Temps pour parcourir 1/4 mile** (en secondes) | Quantitative continue |</span>
<span id="cb98-103"><a href="#cb98-103" aria-hidden="true" tabindex="-1"></a>| <span class="in">`vs`</span> | **Type de moteur** : 0 = moteur en V, 1 = moteur en ligne | Binaire (catégorielle) |</span>
<span id="cb98-104"><a href="#cb98-104" aria-hidden="true" tabindex="-1"></a>| <span class="in">`am`</span> | **Transmission** : 0 = automatique, 1 = manuelle | Binaire (catégorielle) |</span>
<span id="cb98-105"><a href="#cb98-105" aria-hidden="true" tabindex="-1"></a>| <span class="in">`gear`</span> | **Nombre de vitesses** du modèle | Quantitative discrète |</span>
<span id="cb98-106"><a href="#cb98-106" aria-hidden="true" tabindex="-1"></a>| <span class="in">`carb`</span> | **Nombre de carburateurs** | Quantitative discrète |</span>
<span id="cb98-107"><a href="#cb98-107" aria-hidden="true" tabindex="-1"></a>| <span class="in">`Y`</span> | **Variable cible** : copie de <span class="in">`mpg`</span> pour la modélisation | Identique à <span class="in">`mpg`</span> |</span>
<span id="cb98-108"><a href="#cb98-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-109"><a href="#cb98-109" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb98-110"><a href="#cb98-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-111"><a href="#cb98-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remarques</span></span>
<span id="cb98-112"><a href="#cb98-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-113"><a href="#cb98-113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mpg`</span> a été dupliquée en <span class="in">`Y`</span> pour faciliter les analyses de type **régression**.</span>
<span id="cb98-114"><a href="#cb98-114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le dataset ne contient **aucune valeur manquante**, ce qui le rend directement exploitable.</span>
<span id="cb98-115"><a href="#cb98-115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Certaines variables (<span class="in">`vs`</span>, <span class="in">`am`</span>) sont codées en **facteurs binaires** bien que numériques.</span>
<span id="cb98-116"><a href="#cb98-116" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les variables comme <span class="in">`gear`</span>, <span class="in">`carb`</span>, <span class="in">`cyl`</span> sont numériques mais peuvent être traitées comme **catégorielles ordonnées** selon le contexte de l’analyse.</span>
<span id="cb98-117"><a href="#cb98-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-118"><a href="#cb98-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## La matrice des corrélation</span></span>
<span id="cb98-119"><a href="#cb98-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-122"><a href="#cb98-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-123"><a href="#cb98-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de corrélation (sur les variables numériques uniquement)</span></span>
<span id="cb98-124"><a href="#cb98-124" aria-hidden="true" tabindex="-1"></a>vars_numeric <span class="ot">&lt;-</span> <span class="fu">select_if</span>(donnees, is.numeric)</span>
<span id="cb98-125"><a href="#cb98-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-126"><a href="#cb98-126" aria-hidden="true" tabindex="-1"></a><span class="co"># On exclut 'Y' pour éviter la redondance</span></span>
<span id="cb98-127"><a href="#cb98-127" aria-hidden="true" tabindex="-1"></a>vars_cor <span class="ot">&lt;-</span> vars_numeric[, <span class="sc">!</span><span class="fu">names</span>(vars_numeric) <span class="sc">%in%</span> <span class="st">"Y"</span>]</span>
<span id="cb98-128"><a href="#cb98-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-129"><a href="#cb98-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de la matrice de corrélation</span></span>
<span id="cb98-130"><a href="#cb98-130" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb98-131"><a href="#cb98-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-132"><a href="#cb98-132" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ggcorrplot<span class="sc">::</span><span class="fu">ggcorrplot</span>(</span>
<span id="cb98-133"><a href="#cb98-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(vars_cor),</span>
<span id="cb98-134"><a href="#cb98-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">hc.order =</span> <span class="cn">TRUE</span>,</span>
<span id="cb98-135"><a href="#cb98-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb98-136"><a href="#cb98-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab =</span> <span class="cn">TRUE</span>,</span>
<span id="cb98-137"><a href="#cb98-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab_size =</span> <span class="dv">3</span>,</span>
<span id="cb98-138"><a href="#cb98-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>)</span>
<span id="cb98-139"><a href="#cb98-139" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb98-140"><a href="#cb98-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Matrice de Corrélation"</span>) <span class="sc">+</span></span>
<span id="cb98-141"><a href="#cb98-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-142"><a href="#cb98-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-143"><a href="#cb98-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage du graphique</span></span>
<span id="cb98-144"><a href="#cb98-144" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb98-145"><a href="#cb98-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-146"><a href="#cb98-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution des variables numériques avec courbe de densité</span></span>
<span id="cb98-147"><a href="#cb98-147" aria-hidden="true" tabindex="-1"></a>plots_dist <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(vars_numeric), <span class="cf">function</span>(x) {</span>
<span id="cb98-148"><a href="#cb98-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(donnees, <span class="fu">aes_string</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb98-149"><a href="#cb98-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">15</span>, </span>
<span id="cb98-150"><a href="#cb98-150" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb98-151"><a href="#cb98-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb98-152"><a href="#cb98-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Distribution de"</span>, x), <span class="at">x =</span> x, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb98-153"><a href="#cb98-153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_elegant</span>()</span>
<span id="cb98-154"><a href="#cb98-154" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb98-155"><a href="#cb98-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-156"><a href="#cb98-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-157"><a href="#cb98-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-160"><a href="#cb98-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-161"><a href="#cb98-161" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots_dist[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb98-162"><a href="#cb98-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-163"><a href="#cb98-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-164"><a href="#cb98-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interprétation des distributions des variables</span></span>
<span id="cb98-165"><a href="#cb98-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-166"><a href="#cb98-166" aria-hidden="true" tabindex="-1"></a>Les histogrammes avec courbe de densité permettent de visualiser la répartition des valeurs de chaque variable numérique. Voici les principales observations :</span>
<span id="cb98-167"><a href="#cb98-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-168"><a href="#cb98-168" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**mpg (miles per gallon)**\</span>
<span id="cb98-169"><a href="#cb98-169" aria-hidden="true" tabindex="-1"></a>    La distribution est légèrement asymétrique à gauche. La majorité des voitures ont une consommation comprise entre 15 et 25 mpg. Peu de modèles sont très économes (<span class="sc">\&gt;</span>30 mpg). Cette distribution reste proche de la normale, ce qui est favorable pour une régression linéaire, mais une vérification plus poussée pourrait être utile.</span>
<span id="cb98-170"><a href="#cb98-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-171"><a href="#cb98-171" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**cyl (nombre de cylindres)**\</span>
<span id="cb98-172"><a href="#cb98-172" aria-hidden="true" tabindex="-1"></a>    Variable clairement discrète avec trois valeurs dominantes : 4, 6 et 8. Cela montre que <span class="in">`cyl`</span> doit être considérée comme une variable catégorielle, et non comme une variable continue.</span>
<span id="cb98-173"><a href="#cb98-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-174"><a href="#cb98-174" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**disp (cylindrée)**\</span>
<span id="cb98-175"><a href="#cb98-175" aria-hidden="true" tabindex="-1"></a>    Distribution asymétrique à droite. Les valeurs sont concentrées entre 100 et 300, avec quelques cylindrées très élevées. Cette asymétrie pourrait justifier une transformation (logarithmique par exemple) avant modélisation.</span>
<span id="cb98-176"><a href="#cb98-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-177"><a href="#cb98-177" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**hp (puissance du moteur)**\</span>
<span id="cb98-178"><a href="#cb98-178" aria-hidden="true" tabindex="-1"></a>    Là encore, une forte asymétrie à droite est visible. La plupart des voitures ont une puissance entre 80 et 180 chevaux, mais quelques valeurs extrêmes sont présentes. Une transformation peut aider à stabiliser la variance si cette variable est utilisée comme prédicteur.</span>
<span id="cb98-179"><a href="#cb98-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-180"><a href="#cb98-180" aria-hidden="true" tabindex="-1"></a><span class="fu">### Implications pour la modélisation</span></span>
<span id="cb98-181"><a href="#cb98-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-182"><a href="#cb98-182" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les asymétries dans les variables comme <span class="in">`disp`</span> et <span class="in">`hp`</span> peuvent affecter les performances des modèles linéaires. Des transformations peuvent être envisagées pour améliorer les ajustements.</span>
<span id="cb98-183"><a href="#cb98-183" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Des variables comme <span class="in">`cyl`</span> doivent être traitées comme catégorielles. Cela évite d’introduire une relation linéaire artificielle avec la variable cible.</span>
<span id="cb98-184"><a href="#cb98-184" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cette étape permet également de repérer des valeurs atypiques ou extrêmes, qui peuvent avoir un impact important sur les coefficients si elles ne sont pas traitées.</span>
<span id="cb98-185"><a href="#cb98-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-186"><a href="#cb98-186" aria-hidden="true" tabindex="-1"></a>Ces constats orientent la préparation des données avant toute modélisation statistique ou machine learning.</span>
<span id="cb98-187"><a href="#cb98-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-190"><a href="#cb98-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-191"><a href="#cb98-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Liste des variables catégorielles</span></span>
<span id="cb98-192"><a href="#cb98-192" aria-hidden="true" tabindex="-1"></a>vars_cat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cyl"</span>, <span class="st">"am"</span>, <span class="st">"gear"</span>, <span class="st">"vs"</span>, <span class="st">"carb"</span>)</span>
<span id="cb98-193"><a href="#cb98-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-194"><a href="#cb98-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération des boxplots sans modifier le jeu de données</span></span>
<span id="cb98-195"><a href="#cb98-195" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb98-196"><a href="#cb98-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-197"><a href="#cb98-197" aria-hidden="true" tabindex="-1"></a>plots_box <span class="ot">&lt;-</span> <span class="fu">lapply</span>(vars_cat, <span class="cf">function</span>(var) {</span>
<span id="cb98-198"><a href="#cb98-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(donnees, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(.data[[var]]), <span class="at">y =</span> mpg, <span class="at">fill =</span> <span class="fu">factor</span>(.data[[var]]))) <span class="sc">+</span></span>
<span id="cb98-199"><a href="#cb98-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb98-200"><a href="#cb98-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb98-201"><a href="#cb98-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Boxplot de mpg selon"</span>, var),</span>
<span id="cb98-202"><a href="#cb98-202" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> var, <span class="at">y =</span> <span class="st">"mpg"</span>) <span class="sc">+</span></span>
<span id="cb98-203"><a href="#cb98-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb98-204"><a href="#cb98-204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb98-205"><a href="#cb98-205" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb98-206"><a href="#cb98-206" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb98-207"><a href="#cb98-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-208"><a href="#cb98-208" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb98-209"><a href="#cb98-209" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(grid.arrange, <span class="fu">c</span>(plots_box, <span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb98-210"><a href="#cb98-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-211"><a href="#cb98-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-212"><a href="#cb98-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-213"><a href="#cb98-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-214"><a href="#cb98-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analyse des boxplots</span></span>
<span id="cb98-215"><a href="#cb98-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-216"><a href="#cb98-216" aria-hidden="true" tabindex="-1"></a>Les boxplots permettent de visualiser l’impact des variables catégorielles sur la consommation de carburant (<span class="in">`mpg`</span>). Voici les principaux enseignements :</span>
<span id="cb98-217"><a href="#cb98-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-218"><a href="#cb98-218" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**cyl** : plus le nombre de cylindres est élevé, plus la consommation est importante (mpg plus faible). Cette variable montre une relation claire avec la cible.</span>
<span id="cb98-219"><a href="#cb98-219" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**am** : les voitures à transmission manuelle (<span class="in">`am = 1`</span>) sont en moyenne plus économes que celles à transmission automatique.</span>
<span id="cb98-220"><a href="#cb98-220" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**gear** : tendance modérée à la hausse du <span class="in">`mpg`</span> avec le nombre de vitesses, mais les groupes sont déséquilibrés.</span>
<span id="cb98-221"><a href="#cb98-221" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**vs** : les moteurs en ligne (<span class="in">`vs = 1`</span>) sont associés à une meilleure consommation que les moteurs en V.</span>
<span id="cb98-222"><a href="#cb98-222" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**carb** : aucune relation évidente avec <span class="in">`mpg`</span>, forte dispersion selon les catégories. Les groupes avec 4, 6 ou 8 carburateurs sont très peu représentés.</span>
<span id="cb98-223"><a href="#cb98-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-224"><a href="#cb98-224" aria-hidden="true" tabindex="-1"></a>Les variables <span class="in">`cyl`</span>, <span class="in">`am`</span> et <span class="in">`vs`</span> présentent des différences nettes de consommation entre groupes. Elles semblent pertinentes pour une modélisation explicative. D’autres variables comme <span class="in">`gear`</span> et <span class="in">`carb`</span> devront être utilisées avec prudence, en tenant compte de la taille des sous-groupes.</span>
<span id="cb98-225"><a href="#cb98-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-228"><a href="#cb98-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-229"><a href="#cb98-229" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots_dist[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb98-230"><a href="#cb98-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-231"><a href="#cb98-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-232"><a href="#cb98-232" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analyse des distributions</span></span>
<span id="cb98-233"><a href="#cb98-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-234"><a href="#cb98-234" aria-hidden="true" tabindex="-1"></a>Les graphiques de densité permettent de mieux comprendre la répartition de certaines variables explicatives du dataset <span class="in">`mtcars`</span>.</span>
<span id="cb98-235"><a href="#cb98-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-236"><a href="#cb98-236" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**drat (rear axle ratio)**\</span>
<span id="cb98-237"><a href="#cb98-237" aria-hidden="true" tabindex="-1"></a>    La variable présente une distribution assez étalée avec deux pics (vers 3.1 et 3.9). Cela suggère une certaine **hétérogénéité** technique dans les rapports de pont des véhicules. La distribution est peu asymétrique, ce qui est favorable pour une modélisation sans transformation.</span>
<span id="cb98-238"><a href="#cb98-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-239"><a href="#cb98-239" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**wt (poids de la voiture, en milliers de livres)**\</span>
<span id="cb98-240"><a href="#cb98-240" aria-hidden="true" tabindex="-1"></a>    La distribution est **asymétrique à droite** avec une concentration entre 2.5 et 3.5. Ce type de répartition est courant pour des données physiques comme le poids. Une transformation logarithmique pourrait être envisagée si le modèle est sensible à l’échelle.</span>
<span id="cb98-241"><a href="#cb98-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-242"><a href="#cb98-242" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**qsec (temps pour parcourir 1/4 de mile en secondes)**\</span>
<span id="cb98-243"><a href="#cb98-243" aria-hidden="true" tabindex="-1"></a>    Distribution relativement symétrique avec un pic autour de 17 secondes. Cette variable semble adaptée à une modélisation directe, sans transformation.</span>
<span id="cb98-244"><a href="#cb98-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-245"><a href="#cb98-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**vs (type de moteur : 0 = V, 1 = en ligne)**\</span>
<span id="cb98-246"><a href="#cb98-246" aria-hidden="true" tabindex="-1"></a>    Variable binaire avec deux groupes équilibrés. Ce type de variable doit être traité comme un **facteur** dans les analyses. Sa distribution en bâtons confirme sa nature catégorielle.</span>
<span id="cb98-247"><a href="#cb98-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-248"><a href="#cb98-248" aria-hidden="true" tabindex="-1"></a>Les variables <span class="in">`wt`</span>, <span class="in">`drat`</span> et <span class="in">`qsec`</span> présentent des formes exploitables pour une modélisation. On note toutefois une légère asymétrie pour <span class="in">`wt`</span>, à surveiller selon les méthodes utilisées. La variable <span class="in">`vs`</span> est clairement binaire et doit être manipulée comme une variable catégorielle dans les modèles.</span>
<span id="cb98-249"><a href="#cb98-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-250"><a href="#cb98-250" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelisation</span></span>
<span id="cb98-251"><a href="#cb98-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-254"><a href="#cb98-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-255"><a href="#cb98-255" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Modélisation</span></span>
<span id="cb98-256"><a href="#cb98-256" aria-hidden="true" tabindex="-1"></a>modele_complet <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> . <span class="sc">-</span>mpg, <span class="at">data =</span> donnees)</span>
<span id="cb98-257"><a href="#cb98-257" aria-hidden="true" tabindex="-1"></a>summary_complet <span class="ot">&lt;-</span> <span class="fu">summary</span>(modele_complet)</span>
<span id="cb98-258"><a href="#cb98-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-259"><a href="#cb98-259" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== MODÈLE COMPLET ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-260"><a href="#cb98-260" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² ajusté:"</span>, <span class="fu">round</span>(summary_complet<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-261"><a href="#cb98-261" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"F-statistique:"</span>, <span class="fu">round</span>(summary_complet<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>), </span>
<span id="cb98-262"><a href="#cb98-262" aria-hidden="true" tabindex="-1"></a>    <span class="st">"| p-value:"</span>, <span class="fu">format.pval</span>(<span class="fu">pf</span>(summary_complet<span class="sc">$</span>fstatistic[<span class="dv">1</span>], </span>
<span id="cb98-263"><a href="#cb98-263" aria-hidden="true" tabindex="-1"></a>                                 summary_complet<span class="sc">$</span>fstatistic[<span class="dv">2</span>], </span>
<span id="cb98-264"><a href="#cb98-264" aria-hidden="true" tabindex="-1"></a>                                 summary_complet<span class="sc">$</span>fstatistic[<span class="dv">3</span>], </span>
<span id="cb98-265"><a href="#cb98-265" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-266"><a href="#cb98-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-267"><a href="#cb98-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-268"><a href="#cb98-268" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Qualité globale du modèle</span></span>
<span id="cb98-269"><a href="#cb98-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-270"><a href="#cb98-270" aria-hidden="true" tabindex="-1"></a>Bien que le modèle complet présente un bon R² ajusté (0.779) et une F-statistique significative, cela ne garantit pas que toutes les variables explicatives sont utiles individuellement.</span>
<span id="cb98-271"><a href="#cb98-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-272"><a href="#cb98-272" aria-hidden="true" tabindex="-1"></a>Afin de permettre une **meilleure capacité de prévision**, il est essentiel d'examiner la **significativité statistique des coefficients individuels**. En effet, inclure des variables non significatives peut :</span>
<span id="cb98-273"><a href="#cb98-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-274"><a href="#cb98-274" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**complexifier inutilement** le modèle,</span>
<span id="cb98-275"><a href="#cb98-275" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**introduire du bruit** et de l’instabilité dans les prédictions,</span>
<span id="cb98-276"><a href="#cb98-276" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>et nuire à la **généralisation** sur de nouvelles données.</span>
<span id="cb98-277"><a href="#cb98-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-278"><a href="#cb98-278" aria-hidden="true" tabindex="-1"></a>L’analyse des **valeurs p** associées aux coefficients permet d’identifier les variables qui ont un **effet statistiquement démontré** sur la variable cible <span class="in">`mpg`</span>.</span>
<span id="cb98-279"><a href="#cb98-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-280"><a href="#cb98-280" aria-hidden="true" tabindex="-1"></a>Il est donc nécessaire de poursuivre l’analyse en évaluant chaque prédicteur individuellement, et éventuellement de construire un **modèle plus parcimonieux**, en ne retenant que les variables significatives.</span>
<span id="cb98-281"><a href="#cb98-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-284"><a href="#cb98-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-285"><a href="#cb98-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables significatives</span></span>
<span id="cb98-286"><a href="#cb98-286" aria-hidden="true" tabindex="-1"></a>coeff_pvalues <span class="ot">&lt;-</span> summary_complet<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb98-287"><a href="#cb98-287" aria-hidden="true" tabindex="-1"></a>vars_significatives <span class="ot">&lt;-</span> <span class="fu">names</span>(coeff_pvalues)[coeff_pvalues <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> <span class="fu">names</span>(coeff_pvalues) <span class="sc">!=</span> <span class="st">"(Intercept)"</span>]</span>
<span id="cb98-288"><a href="#cb98-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-289"><a href="#cb98-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-290"><a href="#cb98-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-293"><a href="#cb98-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-294"><a href="#cb98-294" aria-hidden="true" tabindex="-1"></a>coeff_pvalues</span>
<span id="cb98-295"><a href="#cb98-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-296"><a href="#cb98-296" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variables significatives:"</span>, <span class="fu">paste</span>(vars_significatives, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-297"><a href="#cb98-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-298"><a href="#cb98-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-299"><a href="#cb98-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## Significativité des variables (seuil 5 %)</span></span>
<span id="cb98-300"><a href="#cb98-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-301"><a href="#cb98-301" aria-hidden="true" tabindex="-1"></a>Aucune des variables explicatives du modèle complet n’est significative au seuil de 5 %. Cela signifie qu’aucun prédicteur, pris isolément, n’apporte une preuve statistique suffisante de son impact sur la consommation <span class="in">`mpg`</span>.</span>
<span id="cb98-302"><a href="#cb98-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-303"><a href="#cb98-303" aria-hidden="true" tabindex="-1"></a>Deux variables (<span class="in">`hp`</span> et <span class="in">`wt`</span>) se rapprochent d’un effet significatif (p ≈ 0.09), mais restent au-dessus du seuil.</span>
<span id="cb98-304"><a href="#cb98-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-305"><a href="#cb98-305" aria-hidden="true" tabindex="-1"></a>Ce résultat suggère que le modèle est probablement affecté par : - une **multicolinéarité** entre variables, - un **nombre trop élevé de variables** pour un échantillon réduit (32 observations).</span>
<span id="cb98-306"><a href="#cb98-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-307"><a href="#cb98-307" aria-hidden="true" tabindex="-1"></a>Le modèle explique bien la variabilité globale de <span class="in">`mpg`</span> (R² ajusté de 77.9 %), mais la **fiabilité individuelle des variables est faible**.\</span>
<span id="cb98-308"><a href="#cb98-308" aria-hidden="true" tabindex="-1"></a>Il sera nécessaire de tester d'autres modèles plus simples ou mieux spécifiés pour améliorer la robustesse et la capacité de prévision.</span>
<span id="cb98-309"><a href="#cb98-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-312"><a href="#cb98-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-313"><a href="#cb98-313" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Diagnostic multicolinéarité avec visualisation</span></span>
<span id="cb98-314"><a href="#cb98-314" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(modele_complet)</span>
<span id="cb98-315"><a href="#cb98-315" aria-hidden="true" tabindex="-1"></a>vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">names</span>(vif_values), <span class="at">VIF =</span> vif_values)</span>
<span id="cb98-316"><a href="#cb98-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-317"><a href="#cb98-317" aria-hidden="true" tabindex="-1"></a>p_vif <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF), <span class="at">y =</span> VIF)) <span class="sc">+</span></span>
<span id="cb98-318"><a href="#cb98-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">ifelse</span>(vif_df<span class="sc">$</span>VIF <span class="sc">&gt;</span> <span class="dv">5</span>, <span class="st">"#E46726"</span>, <span class="st">"steelblue"</span>), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb98-319"><a href="#cb98-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-320"><a href="#cb98-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb98-321"><a href="#cb98-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Facteurs d'Inflation de la Variance (VIF)"</span>, </span>
<span id="cb98-322"><a href="#cb98-322" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Ligne rouge: seuil critique (VIF = 5)"</span>,</span>
<span id="cb98-323"><a href="#cb98-323" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"VIF"</span>) <span class="sc">+</span></span>
<span id="cb98-324"><a href="#cb98-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-325"><a href="#cb98-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-326"><a href="#cb98-326" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_vif)</span>
<span id="cb98-327"><a href="#cb98-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-328"><a href="#cb98-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-329"><a href="#cb98-329" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb98-330"><a href="#cb98-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-331"><a href="#cb98-331" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnostic de multicolinéarité</span></span>
<span id="cb98-332"><a href="#cb98-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-333"><a href="#cb98-333" aria-hidden="true" tabindex="-1"></a>Le graphique ci-dessus présente les **valeurs des facteurs d'inflation de la variance (VIF)** associés à chaque variable explicative. Ces indicateurs permettent de détecter la présence de **multicolinéarité**, c’est-à-dire des redondances fortes entre variables.</span>
<span id="cb98-334"><a href="#cb98-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-335"><a href="#cb98-335" aria-hidden="true" tabindex="-1"></a>Un VIF supérieur à **5** est généralement considéré comme critique, car il indique qu’une variable est fortement corrélée à d'autres prédicteurs, ce qui peut rendre les coefficients instables et peu interprétables.</span>
<span id="cb98-336"><a href="#cb98-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-337"><a href="#cb98-337" aria-hidden="true" tabindex="-1"></a>Plusieurs variables dépassent ce seuil : - <span class="in">`disp`</span> atteint un VIF supérieur à 20, signe d’une colinéarité très marquée. - <span class="in">`cyl`</span>, <span class="in">`wt`</span>, <span class="in">`hp`</span> présentent également des VIF élevés (<span class="sc">\&gt;</span>10). - <span class="in">`carb`</span>, <span class="in">`qsec`</span> et <span class="in">`gear`</span> se situent juste au-dessus du seuil de vigilance.</span>
<span id="cb98-338"><a href="#cb98-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-339"><a href="#cb98-339" aria-hidden="true" tabindex="-1"></a>À l’inverse, certaines variables comme <span class="in">`vs`</span>, <span class="in">`am`</span> et <span class="in">`drat`</span> affichent des VIF inférieurs à 5, suggérant une absence de redondance problématique.</span>
<span id="cb98-340"><a href="#cb98-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-341"><a href="#cb98-341" aria-hidden="true" tabindex="-1"></a><span class="fu">### Enjeux pour la modélisation</span></span>
<span id="cb98-342"><a href="#cb98-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-343"><a href="#cb98-343" aria-hidden="true" tabindex="-1"></a>Cette situation de **colinéarité importante** entre plusieurs variables peut fragiliser l'estimation des effets individuels et nuire à la stabilité des prévisions.\</span>
<span id="cb98-344"><a href="#cb98-344" aria-hidden="true" tabindex="-1"></a>Cela renforce l’intérêt d’un **ajustement du modèle**, soit par sélection de variables, soit via des approches pénalisées (ex. : ridge, lasso).</span>
<span id="cb98-345"><a href="#cb98-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-346"><a href="#cb98-346" aria-hidden="true" tabindex="-1"></a>Mais avant toute simplification, il est important de vérifier que le modèle respecte bien les **autres hypothèses fondamentales**, notamment concernant la distribution des résidus.</span>
<span id="cb98-347"><a href="#cb98-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-350"><a href="#cb98-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-351"><a href="#cb98-351" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Diagnostic des résidus avec graphiques élégants</span></span>
<span id="cb98-352"><a href="#cb98-352" aria-hidden="true" tabindex="-1"></a>residus <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modele_complet)</span>
<span id="cb98-353"><a href="#cb98-353" aria-hidden="true" tabindex="-1"></a>valeurs_ajustees <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modele_complet)</span>
<span id="cb98-354"><a href="#cb98-354" aria-hidden="true" tabindex="-1"></a>residus_std <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(modele_complet)</span>
<span id="cb98-355"><a href="#cb98-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-356"><a href="#cb98-356" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests statistiques</span></span>
<span id="cb98-357"><a href="#cb98-357" aria-hidden="true" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(residus)</span>
<span id="cb98-358"><a href="#cb98-358" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> <span class="fu">ncvTest</span>(modele_complet)</span>
<span id="cb98-359"><a href="#cb98-359" aria-hidden="true" tabindex="-1"></a>dw_test <span class="ot">&lt;-</span> <span class="fu">durbinWatsonTest</span>(modele_complet)</span>
<span id="cb98-360"><a href="#cb98-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-361"><a href="#cb98-361" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== DIAGNOSTIC DES RÉSIDUS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-362"><a href="#cb98-362" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Normalité (Shapiro):"</span>, <span class="fu">format.pval</span>(shapiro_test<span class="sc">$</span>p.value), </span>
<span id="cb98-363"><a href="#cb98-363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">" ✓"</span>, <span class="st">" ✗"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-364"><a href="#cb98-364" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Homoscédasticité (BP):"</span>, <span class="fu">format.pval</span>(bp_test<span class="sc">$</span>p), </span>
<span id="cb98-365"><a href="#cb98-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(bp_test<span class="sc">$</span>p <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">" ✓"</span>, <span class="st">" ✗"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-366"><a href="#cb98-366" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Indépendance (DW):"</span>, <span class="fu">format.pval</span>(dw_test<span class="sc">$</span>p), </span>
<span id="cb98-367"><a href="#cb98-367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(dw_test<span class="sc">$</span>p <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">" ✓"</span>, <span class="st">" ✗"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-368"><a href="#cb98-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-369"><a href="#cb98-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-370"><a href="#cb98-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-371"><a href="#cb98-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-372"><a href="#cb98-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-373"><a href="#cb98-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-374"><a href="#cb98-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-375"><a href="#cb98-375" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualisation des résidus</span></span>
<span id="cb98-376"><a href="#cb98-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-377"><a href="#cb98-377" aria-hidden="true" tabindex="-1"></a>Au-delà des tests statistiques, il est essentiel d’appuyer le diagnostic du modèle par une **analyse visuelle des résidus**. Les graphiques suivants permettent de vérifier de manière plus intuitive la qualité de l’ajustement et la validité des hypothèses.</span>
<span id="cb98-378"><a href="#cb98-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-379"><a href="#cb98-379" aria-hidden="true" tabindex="-1"></a>Quatre visualisations complémentaires sont produites :</span>
<span id="cb98-380"><a href="#cb98-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-381"><a href="#cb98-381" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Résidus vs valeurs ajustées**\</span>
<span id="cb98-382"><a href="#cb98-382" aria-hidden="true" tabindex="-1"></a>    Permet de détecter une éventuelle structure dans les résidus (effets non modélisés, non-linéarités, hétéroscédasticité).</span>
<span id="cb98-383"><a href="#cb98-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-384"><a href="#cb98-384" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Q-Q plot des résidus**\</span>
<span id="cb98-385"><a href="#cb98-385" aria-hidden="true" tabindex="-1"></a>    Sert à évaluer si les résidus suivent une loi normale. Un bon alignement des points sur la droite théorique indique une normalité satisfaisante.</span>
<span id="cb98-386"><a href="#cb98-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-387"><a href="#cb98-387" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Histogramme des résidus avec densité**\</span>
<span id="cb98-388"><a href="#cb98-388" aria-hidden="true" tabindex="-1"></a>    Complète le Q-Q plot en visualisant la forme globale de la distribution des erreurs, comparée à une densité normale.</span>
<span id="cb98-389"><a href="#cb98-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-390"><a href="#cb98-390" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Observé vs Prédit**\</span>
<span id="cb98-391"><a href="#cb98-391" aria-hidden="true" tabindex="-1"></a>    Donne une idée de la qualité globale de l’ajustement : plus les points sont proches de la diagonale, plus le modèle prédit fidèlement les valeurs observées.</span>
<span id="cb98-392"><a href="#cb98-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-393"><a href="#cb98-393" aria-hidden="true" tabindex="-1"></a>Ces graphiques renforcent ou nuancent les résultats des tests précédents, et permettent d’identifier visuellement des pistes d'amélioration du modèle.</span>
<span id="cb98-394"><a href="#cb98-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-397"><a href="#cb98-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-398"><a href="#cb98-398" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphiques de diagnostic </span></span>
<span id="cb98-399"><a href="#cb98-399" aria-hidden="true" tabindex="-1"></a>p_resid1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">fitted =</span> valeurs_ajustees, <span class="at">residuals =</span> residus), </span>
<span id="cb98-400"><a href="#cb98-400" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb98-401"><a href="#cb98-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb98-402"><a href="#cb98-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb98-403"><a href="#cb98-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb98-404"><a href="#cb98-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Résidus vs Valeurs Ajustées"</span>, <span class="at">x =</span> <span class="st">"Valeurs ajustées"</span>, <span class="at">y =</span> <span class="st">"Résidus"</span>) <span class="sc">+</span></span>
<span id="cb98-405"><a href="#cb98-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-406"><a href="#cb98-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-407"><a href="#cb98-407" aria-hidden="true" tabindex="-1"></a>p_qq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">residuals =</span> residus), <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb98-408"><a href="#cb98-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb98-409"><a href="#cb98-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb98-410"><a href="#cb98-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q Plot des Résidus"</span>, <span class="at">x =</span> <span class="st">"Quantiles théoriques"</span>, <span class="at">y =</span> <span class="st">"Quantiles observés"</span>) <span class="sc">+</span></span>
<span id="cb98-411"><a href="#cb98-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-412"><a href="#cb98-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-413"><a href="#cb98-413" aria-hidden="true" tabindex="-1"></a>p_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">residuals =</span> residus), <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb98-414"><a href="#cb98-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb98-415"><a href="#cb98-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb98-416"><a href="#cb98-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sd</span>(residus)), </span>
<span id="cb98-417"><a href="#cb98-417" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-418"><a href="#cb98-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Résidus"</span>, <span class="at">x =</span> <span class="st">"Résidus"</span>, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb98-419"><a href="#cb98-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-420"><a href="#cb98-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-421"><a href="#cb98-421" aria-hidden="true" tabindex="-1"></a>p_obs_pred <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">observed =</span> donnees<span class="sc">$</span>Y, <span class="at">predicted =</span> valeurs_ajustees), </span>
<span id="cb98-422"><a href="#cb98-422" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb98-423"><a href="#cb98-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb98-424"><a href="#cb98-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb98-425"><a href="#cb98-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb98-426"><a href="#cb98-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observé vs Prédit"</span>, </span>
<span id="cb98-427"><a href="#cb98-427" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"R² ="</span>, <span class="fu">round</span>(summary_complet<span class="sc">$</span>r.squared, <span class="dv">3</span>)),</span>
<span id="cb98-428"><a href="#cb98-428" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valeurs observées"</span>, <span class="at">y =</span> <span class="st">"Valeurs prédites"</span>) <span class="sc">+</span></span>
<span id="cb98-429"><a href="#cb98-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-430"><a href="#cb98-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-431"><a href="#cb98-431" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p_resid1, p_qq, p_hist, p_obs_pred, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb98-432"><a href="#cb98-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-433"><a href="#cb98-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-434"><a href="#cb98-434" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualisation des résidus</span></span>
<span id="cb98-435"><a href="#cb98-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-436"><a href="#cb98-436" aria-hidden="true" tabindex="-1"></a>Les tests statistiques réalisés précédemment ont permis de valider les hypothèses globales du modèle (normalité, homoscédasticité), à l’exception d’un doute sur l’indépendance des erreurs.\</span>
<span id="cb98-437"><a href="#cb98-437" aria-hidden="true" tabindex="-1"></a>Pour compléter ces diagnostics, plusieurs **graphiques exploratoires** sont produits afin de visualiser directement le comportement des résidus.</span>
<span id="cb98-438"><a href="#cb98-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-439"><a href="#cb98-439" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Résidus vs Valeurs ajustées</span></span>
<span id="cb98-440"><a href="#cb98-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-441"><a href="#cb98-441" aria-hidden="true" tabindex="-1"></a>La courbe de tendance révèle une forme légèrement incurvée, indiquant une possible **non-linéarité résiduelle** ou un effet non capté par le modèle.\</span>
<span id="cb98-442"><a href="#cb98-442" aria-hidden="true" tabindex="-1"></a>Les résidus ne sont pas totalement aléatoires autour de zéro, ce qui suggère qu'une partie de la structure des données reste inexpliquée.</span>
<span id="cb98-443"><a href="#cb98-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-444"><a href="#cb98-444" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Q-Q Plot des résidus</span></span>
<span id="cb98-445"><a href="#cb98-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-446"><a href="#cb98-446" aria-hidden="true" tabindex="-1"></a>Les points sont globalement bien alignés sur la droite théorique, avec quelques écarts aux extrémités.\</span>
<span id="cb98-447"><a href="#cb98-447" aria-hidden="true" tabindex="-1"></a>Cela confirme une **normalité raisonnable** des résidus, malgré quelques observations atypiques.</span>
<span id="cb98-448"><a href="#cb98-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-449"><a href="#cb98-449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Distribution des résidus</span></span>
<span id="cb98-450"><a href="#cb98-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-451"><a href="#cb98-451" aria-hidden="true" tabindex="-1"></a>L’histogramme montre une distribution relativement symétrique, avec une densité légèrement plus aplatie que la courbe normale de référence.\</span>
<span id="cb98-452"><a href="#cb98-452" aria-hidden="true" tabindex="-1"></a>La normalité est globalement respectée, mais on note une **légère sous-dispersion**.</span>
<span id="cb98-453"><a href="#cb98-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-454"><a href="#cb98-454" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Observé vs Prédit</span></span>
<span id="cb98-455"><a href="#cb98-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-456"><a href="#cb98-456" aria-hidden="true" tabindex="-1"></a>Les valeurs prédites suivent bien la diagonale, avec un **R² de 0.869**, signe d’un ajustement satisfaisant dans l’ensemble.\</span>
<span id="cb98-457"><a href="#cb98-457" aria-hidden="true" tabindex="-1"></a>Toutefois, quelques points s’écartent de la tendance, ce qui reflète les limites du modèle complet.</span>
<span id="cb98-458"><a href="#cb98-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-459"><a href="#cb98-459" aria-hidden="true" tabindex="-1"></a>Le diagnostic visuel confirme que le modèle capte bien la tendance générale, mais **la présence de courbure dans les résidus** et **l’instabilité liée à la multicolinéarité** justifient l’exploration de modèles alternatifs.\</span>
<span id="cb98-460"><a href="#cb98-460" aria-hidden="true" tabindex="-1"></a>C’est dans ce cadre qu'on doit proceder à **la sélection de variables**, à travers des approches classiques et régularisées.</span>
<span id="cb98-461"><a href="#cb98-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-462"><a href="#cb98-462" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modèles</span></span>
<span id="cb98-463"><a href="#cb98-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-466"><a href="#cb98-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-467"><a href="#cb98-467" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Sélection de variables</span></span>
<span id="cb98-468"><a href="#cb98-468" aria-hidden="true" tabindex="-1"></a>model_null <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> donnees)</span>
<span id="cb98-469"><a href="#cb98-469" aria-hidden="true" tabindex="-1"></a>model_forward <span class="ot">&lt;-</span> <span class="fu">step</span>(model_null, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> model_null, <span class="at">upper =</span> modele_complet),</span>
<span id="cb98-470"><a href="#cb98-470" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb98-471"><a href="#cb98-471" aria-hidden="true" tabindex="-1"></a>model_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb98-472"><a href="#cb98-472" aria-hidden="true" tabindex="-1"></a>model_stepwise <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb98-473"><a href="#cb98-473" aria-hidden="true" tabindex="-1"></a>model_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb98-474"><a href="#cb98-474" aria-hidden="true" tabindex="-1"></a>model_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(modele_complet, <span class="at">k =</span> <span class="fu">log</span>(<span class="fu">nrow</span>(donnees)), <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb98-475"><a href="#cb98-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-476"><a href="#cb98-476" aria-hidden="true" tabindex="-1"></a><span class="co"># LASSO avec visualisation du chemin</span></span>
<span id="cb98-477"><a href="#cb98-477" aria-hidden="true" tabindex="-1"></a>x_matrix <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Y <span class="sc">~</span> . <span class="sc">-</span>mpg, <span class="at">data =</span> donnees)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb98-478"><a href="#cb98-478" aria-hidden="true" tabindex="-1"></a>y_vector <span class="ot">&lt;-</span> donnees<span class="sc">$</span>Y</span>
<span id="cb98-479"><a href="#cb98-479" aria-hidden="true" tabindex="-1"></a>cv_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_matrix, y_vector, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb98-480"><a href="#cb98-480" aria-hidden="true" tabindex="-1"></a>model_lasso_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb98-481"><a href="#cb98-481" aria-hidden="true" tabindex="-1"></a>vars_lasso <span class="ot">&lt;-</span> <span class="fu">rownames</span>(model_lasso_coef)[<span class="fu">which</span>(model_lasso_coef <span class="sc">!=</span> <span class="dv">0</span>)][<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb98-482"><a href="#cb98-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-483"><a href="#cb98-483" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique LASSO élégant</span></span>
<span id="cb98-484"><a href="#cb98-484" aria-hidden="true" tabindex="-1"></a>lasso_fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_matrix, y_vector, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb98-485"><a href="#cb98-485" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-486"><a href="#cb98-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda =</span> lasso_fit<span class="sc">$</span>lambda,</span>
<span id="cb98-487"><a href="#cb98-487" aria-hidden="true" tabindex="-1"></a>  <span class="at">dev_ratio =</span> lasso_fit<span class="sc">$</span>dev.ratio</span>
<span id="cb98-488"><a href="#cb98-488" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-489"><a href="#cb98-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-490"><a href="#cb98-490" aria-hidden="true" tabindex="-1"></a>p_lasso <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(lambda), <span class="at">y =</span> dev_ratio)) <span class="sc">+</span></span>
<span id="cb98-491"><a href="#cb98-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#E46726"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb98-492"><a href="#cb98-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">log</span>(cv_lasso<span class="sc">$</span>lambda.min), <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb98-493"><a href="#cb98-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">log</span>(cv_lasso<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb98-494"><a href="#cb98-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Régularisation LASSO"</span>, </span>
<span id="cb98-495"><a href="#cb98-495" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Lignes: λ min (bleu) et λ 1SE (vert)"</span>,</span>
<span id="cb98-496"><a href="#cb98-496" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"log(λ)"</span>, <span class="at">y =</span> <span class="st">"Proportion de déviance expliquée"</span>) <span class="sc">+</span></span>
<span id="cb98-497"><a href="#cb98-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-498"><a href="#cb98-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-499"><a href="#cb98-499" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_lasso)</span>
<span id="cb98-500"><a href="#cb98-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-501"><a href="#cb98-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-502"><a href="#cb98-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-503"><a href="#cb98-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-504"><a href="#cb98-504" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sélection de variables et critères d’information</span></span>
<span id="cb98-505"><a href="#cb98-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-506"><a href="#cb98-506" aria-hidden="true" tabindex="-1"></a>Pour simplifier le modèle tout en maintenant sa capacité explicative, plusieurs méthodes de sélection ont été appliquées. Elles reposent sur l’optimisation de critères d’information, qui mesurent le compromis entre **qualité d’ajustement** et **complexité du modèle**.</span>
<span id="cb98-507"><a href="#cb98-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-508"><a href="#cb98-508" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Formules des critères d'information</span></span>
<span id="cb98-509"><a href="#cb98-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-510"><a href="#cb98-510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**AIC (Akaike Information Criterion)**\</span>
<span id="cb98-511"><a href="#cb98-511" aria-hidden="true" tabindex="-1"></a>    $$ \text{AIC} = -2 \log(\mathcal{L}) + 2k $$</span>
<span id="cb98-512"><a href="#cb98-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-513"><a href="#cb98-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**BIC (Bayesian Information Criterion)**\</span>
<span id="cb98-514"><a href="#cb98-514" aria-hidden="true" tabindex="-1"></a>    $$ \text{BIC} = -2 \log(\mathcal{L}) + k \log(n) $$</span>
<span id="cb98-515"><a href="#cb98-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-516"><a href="#cb98-516" aria-hidden="true" tabindex="-1"></a>où :</span>
<span id="cb98-517"><a href="#cb98-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-518"><a href="#cb98-518" aria-hidden="true" tabindex="-1"></a>$$\log(\mathcal{L})$$ est le log-vraisemblance du modèle, $$k$$ est le nombre de paramètres estimés, $$n$$ est le nombre d’observations.</span>
<span id="cb98-519"><a href="#cb98-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-520"><a href="#cb98-520" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interprétation</span></span>
<span id="cb98-521"><a href="#cb98-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-522"><a href="#cb98-522" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ces critères pénalisent les modèles trop complexes : plus ($$k$$) est élevé, plus la pénalité est forte.</span>
<span id="cb98-523"><a href="#cb98-523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**AIC** favorise généralement les modèles explicatifs (moins pénalisant).</span>
<span id="cb98-524"><a href="#cb98-524" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**BIC** est plus conservateur, il privilégie les modèles **plus simples** si la taille de l’échantillon est petite ou moyenne.</span>
<span id="cb98-525"><a href="#cb98-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-526"><a href="#cb98-526" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Implication</span></span>
<span id="cb98-527"><a href="#cb98-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-528"><a href="#cb98-528" aria-hidden="true" tabindex="-1"></a>Minimiser l’AIC ou le BIC revient à **trouver le meilleur compromis entre ajustement et parcimonie**.\</span>
<span id="cb98-529"><a href="#cb98-529" aria-hidden="true" tabindex="-1"></a>Dans ce contexte : - AIC est utile pour un **modèle prédictif performant**. - BIC est préférable si l’objectif est **l’interprétation claire et robuste** du modèle.</span>
<span id="cb98-530"><a href="#cb98-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-531"><a href="#cb98-531" aria-hidden="true" tabindex="-1"></a>Ces approches sont complémentaires de la régularisation LASSO, qui sélectionne automatiquement les variables les plus contributives tout en réduisant le risque de surajustement.</span>
<span id="cb98-532"><a href="#cb98-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-535"><a href="#cb98-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-536"><a href="#cb98-536" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== SÉLECTION DE VARIABLES ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-537"><a href="#cb98-537" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Forward  :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_forward))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-538"><a href="#cb98-538" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Backward :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_backward))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-539"><a href="#cb98-539" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Stepwise :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_stepwise))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-540"><a href="#cb98-540" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC      :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_aic))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-541"><a href="#cb98-541" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC      :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(model_bic))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-542"><a href="#cb98-542" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"LASSO    :"</span>, <span class="fu">paste</span>(vars_lasso, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-543"><a href="#cb98-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-544"><a href="#cb98-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-545"><a href="#cb98-545" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sélection de variables</span></span>
<span id="cb98-546"><a href="#cb98-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-547"><a href="#cb98-547" aria-hidden="true" tabindex="-1"></a>Différentes méthodes de sélection ont été appliquées (stepwise, AIC, BIC, LASSO) afin d’identifier un sous-ensemble optimal de variables explicatives pour modéliser <span class="in">`mpg`</span>.</span>
<span id="cb98-548"><a href="#cb98-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-549"><a href="#cb98-549" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Points de convergence</span></span>
<span id="cb98-550"><a href="#cb98-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-551"><a href="#cb98-551" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>La variable **`wt`** (poids du véhicule) est sélectionnée **par toutes les méthodes**, confirmant son rôle déterminant dans la consommation.</span>
<span id="cb98-552"><a href="#cb98-552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les approches **AIC**, **BIC**, **stepwise** et **backward** aboutissent exactement au même trio de variables : <span class="in">`wt`</span>, <span class="in">`qsec`</span> et <span class="in">`am`</span>.\</span>
<span id="cb98-553"><a href="#cb98-553" aria-hidden="true" tabindex="-1"></a>    → Ce modèle est **court, cohérent**, et respecte les critères de parcimonie tout en conservant une bonne qualité d’ajustement.</span>
<span id="cb98-554"><a href="#cb98-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-555"><a href="#cb98-555" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Apports spécifiques</span></span>
<span id="cb98-556"><a href="#cb98-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-557"><a href="#cb98-557" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**LASSO** identifie un modèle plus large, incluant <span class="in">`wt`</span>, <span class="in">`cyl`</span>, <span class="in">`hp`</span>, <span class="in">`am`</span> et <span class="in">`carb`</span>.\</span>
<span id="cb98-558"><a href="#cb98-558" aria-hidden="true" tabindex="-1"></a>    Cela reflète une stratégie orientée vers la **performance prédictive**, en retenant des variables partiellement redondantes mais contributives.</span>
<span id="cb98-559"><a href="#cb98-559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Forward selection** (ajout progressif) retient <span class="in">`wt`</span>, <span class="in">`cyl`</span>, <span class="in">`hp`</span> — ce qui rejoint partiellement LASSO — mais ignore <span class="in">`am`</span> et <span class="in">`qsec`</span>.</span>
<span id="cb98-560"><a href="#cb98-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-561"><a href="#cb98-561" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interprétation</span></span>
<span id="cb98-562"><a href="#cb98-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-563"><a href="#cb98-563" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le fait que <span class="in">`cyl`</span>, <span class="in">`hp`</span> et <span class="in">`carb`</span> soient **retenues par LASSO mais écartées par BIC** montre qu’elles contiennent de l'information, mais au prix d'une plus grande complexité.</span>
<span id="cb98-564"><a href="#cb98-564" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`qsec`** (temps sur un quart de mile) est conservée uniquement par les approches classiques, probablement car elle capte une part de variance résiduelle non prise en compte par les variables moteur.</span>
<span id="cb98-565"><a href="#cb98-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-566"><a href="#cb98-566" aria-hidden="true" tabindex="-1"></a><span class="fu">### Implication</span></span>
<span id="cb98-567"><a href="#cb98-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-568"><a href="#cb98-568" aria-hidden="true" tabindex="-1"></a>Deux stratégies sont envisageables : - **Modèle parsimonieux** : `wt`, `qsec`, `am` → stable, simple à interpréter, adapté à l’explication. - **Modèle régularisé** : <span class="in">`wt`</span>, <span class="in">`cyl`</span>, <span class="in">`hp`</span>, <span class="in">`am`</span>, <span class="in">`carb`</span> → potentiellement plus performant en prédiction, mais moins lisible.</span>
<span id="cb98-569"><a href="#cb98-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-570"><a href="#cb98-570" aria-hidden="true" tabindex="-1"></a>La prochaine étape consistera à **comparer ces modèles** sur la base de leur performance (R² ajusté, AIC, etc.) et de la qualité des résidus.</span>
<span id="cb98-571"><a href="#cb98-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-574"><a href="#cb98-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-575"><a href="#cb98-575" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Comparaison des modèles avec visualisation</span></span>
<span id="cb98-576"><a href="#cb98-576" aria-hidden="true" tabindex="-1"></a>models_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb98-577"><a href="#cb98-577" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Complet"</span> <span class="ot">=</span> modele_complet,</span>
<span id="cb98-578"><a href="#cb98-578" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Forward"</span> <span class="ot">=</span> model_forward,</span>
<span id="cb98-579"><a href="#cb98-579" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Backward"</span> <span class="ot">=</span> model_backward,</span>
<span id="cb98-580"><a href="#cb98-580" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Stepwise"</span> <span class="ot">=</span> model_stepwise,</span>
<span id="cb98-581"><a href="#cb98-581" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AIC"</span> <span class="ot">=</span> model_aic,</span>
<span id="cb98-582"><a href="#cb98-582" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BIC"</span> <span class="ot">=</span> model_bic</span>
<span id="cb98-583"><a href="#cb98-583" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-584"><a href="#cb98-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-585"><a href="#cb98-585" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-586"><a href="#cb98-586" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modele =</span> <span class="fu">names</span>(models_list),</span>
<span id="cb98-587"><a href="#cb98-587" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_Vars =</span> <span class="fu">sapply</span>(models_list, <span class="cf">function</span>(m) <span class="fu">length</span>(<span class="fu">coef</span>(m)) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb98-588"><a href="#cb98-588" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_Adj =</span> <span class="fu">sapply</span>(models_list, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb98-589"><a href="#cb98-589" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">sapply</span>(models_list, AIC),</span>
<span id="cb98-590"><a href="#cb98-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC =</span> <span class="fu">sapply</span>(models_list, BIC),</span>
<span id="cb98-591"><a href="#cb98-591" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">sapply</span>(models_list, <span class="cf">function</span>(m) <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(m)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb98-592"><a href="#cb98-592" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-593"><a href="#cb98-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-594"><a href="#cb98-594" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> comparison[<span class="fu">order</span>(comparison<span class="sc">$</span>R2_Adj, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb98-595"><a href="#cb98-595" aria-hidden="true" tabindex="-1"></a>comparison[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(comparison[, <span class="sc">-</span><span class="dv">1</span>], <span class="dv">4</span>)</span>
<span id="cb98-596"><a href="#cb98-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-597"><a href="#cb98-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-598"><a href="#cb98-598" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique de comparaison </span></span>
<span id="cb98-599"><a href="#cb98-599" aria-hidden="true" tabindex="-1"></a>comp_long <span class="ot">&lt;-</span> comparison <span class="sc">%&gt;%</span></span>
<span id="cb98-600"><a href="#cb98-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Modele, R2_Adj, AIC, BIC, RMSE) <span class="sc">%&gt;%</span></span>
<span id="cb98-601"><a href="#cb98-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Modele, <span class="at">names_to =</span> <span class="st">"Metric"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb98-602"><a href="#cb98-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-603"><a href="#cb98-603" aria-hidden="true" tabindex="-1"></a>p_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comp_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Modele, <span class="fu">ifelse</span>(Metric <span class="sc">==</span> <span class="st">"R2_Adj"</span>, Value, <span class="sc">-</span>Value)), </span>
<span id="cb98-604"><a href="#cb98-604" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> Value, <span class="at">fill =</span> Modele)) <span class="sc">+</span></span>
<span id="cb98-605"><a href="#cb98-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb98-606"><a href="#cb98-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Metric, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb98-607"><a href="#cb98-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb98-608"><a href="#cb98-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb98-609"><a href="#cb98-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparaison des Modèles"</span>, <span class="at">x =</span> <span class="st">"Modèle"</span>, <span class="at">y =</span> <span class="st">"Valeur"</span>) <span class="sc">+</span></span>
<span id="cb98-610"><a href="#cb98-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-611"><a href="#cb98-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-612"><a href="#cb98-612" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_comp)</span>
<span id="cb98-613"><a href="#cb98-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-614"><a href="#cb98-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-615"><a href="#cb98-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-618"><a href="#cb98-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-619"><a href="#cb98-619" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span>
<span id="cb98-620"><a href="#cb98-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-621"><a href="#cb98-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-622"><a href="#cb98-622" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparaison des modèles sélectionnés</span></span>
<span id="cb98-623"><a href="#cb98-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-624"><a href="#cb98-624" aria-hidden="true" tabindex="-1"></a>Les modèles issus des différentes méthodes de sélection ont été évalués selon quatre critères complémentaires :</span>
<span id="cb98-625"><a href="#cb98-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-626"><a href="#cb98-626" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**R² ajusté** : mesure la proportion de variance expliquée en tenant compte du nombre de variables.</span>
<span id="cb98-627"><a href="#cb98-627" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**AIC** et **BIC** : critères d’information pénalisant la complexité du modèle.</span>
<span id="cb98-628"><a href="#cb98-628" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**RMSE** (Root Mean Squared Error) : mesure l’erreur moyenne de prédiction.</span>
<span id="cb98-629"><a href="#cb98-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-630"><a href="#cb98-630" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Résultats observés</span></span>
<span id="cb98-631"><a href="#cb98-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-632"><a href="#cb98-632" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les modèles issus de **stepwise**, **backward**, **AIC** et **BIC** sont **strictement équivalents** : même nombre de variables (3), même R² ajusté (≈ 0.8336), AIC et BIC minimaux, RMSE identique (2.30).</span>
<span id="cb98-633"><a href="#cb98-633" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le modèle **forward** est légèrement moins performant (R² ≈ 0.826), avec une erreur de prédiction un peu plus élevée (RMSE = 2.35).</span>
<span id="cb98-634"><a href="#cb98-634" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le **modèle complet**, bien qu’ayant le R² le plus élevé, est **pénalisé par sa complexité** : AIC, BIC et RMSE sont moins favorables.</span>
<span id="cb98-635"><a href="#cb98-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-636"><a href="#cb98-636" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interprétation</span></span>
<span id="cb98-637"><a href="#cb98-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-638"><a href="#cb98-638" aria-hidden="true" tabindex="-1"></a>→ Le **modèle retenu** est donc celui sélectionné par **BIC / AIC / backward / stepwise** : il maximise l’efficacité explicative tout en restant simple et interprétable (<span class="in">`wt`</span>, <span class="in">`qsec`</span>, <span class="in">`am`</span>).</span>
<span id="cb98-639"><a href="#cb98-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-640"><a href="#cb98-640" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb98-641"><a href="#cb98-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-642"><a href="#cb98-642" aria-hidden="true" tabindex="-1"></a><span class="fu">### Étape suivante : validation croisée (LOOCV)</span></span>
<span id="cb98-643"><a href="#cb98-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-644"><a href="#cb98-644" aria-hidden="true" tabindex="-1"></a>Pour évaluer la **robustesse du modèle retenu** et sa capacité à bien généraliser hors échantillon, une **validation croisée Leave-One-Out** (LOOCV) est réalisée.</span>
<span id="cb98-645"><a href="#cb98-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-646"><a href="#cb98-646" aria-hidden="true" tabindex="-1"></a>Cette méthode consiste à : - entraîner le modèle sur *n-1* observations, - tester sa prédiction sur la *nième*, - répéter l’opération pour chaque observation.</span>
<span id="cb98-647"><a href="#cb98-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-648"><a href="#cb98-648" aria-hidden="true" tabindex="-1"></a>Elle permet d’obtenir une **estimation credible de l’erreur de prédiction** (RMSE CV), ainsi qu’un R² croisé qui reflète la stabilité du modèle sur des données nouvelles.</span>
<span id="cb98-649"><a href="#cb98-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-650"><a href="#cb98-650" aria-hidden="true" tabindex="-1"></a>La prochaine visualisation mettra en regard les valeurs observées et les valeurs prédites par validation croisée.</span>
<span id="cb98-651"><a href="#cb98-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-654"><a href="#cb98-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-655"><a href="#cb98-655" aria-hidden="true" tabindex="-1"></a><span class="co"># === 8. Modèle final et validation croisée (LOOCV) ===</span></span>
<span id="cb98-656"><a href="#cb98-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-657"><a href="#cb98-657" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Sélection du meilleur modèle (le 1er dans le tableau de comparaison)</span></span>
<span id="cb98-658"><a href="#cb98-658" aria-hidden="true" tabindex="-1"></a>best_model_name <span class="ot">&lt;-</span> comparison<span class="sc">$</span>Modele[<span class="dv">1</span>]</span>
<span id="cb98-659"><a href="#cb98-659" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> models_list[[best_model_name]]</span>
<span id="cb98-660"><a href="#cb98-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-661"><a href="#cb98-661" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Validation croisée Leave-One-Out (LOOCV)</span></span>
<span id="cb98-662"><a href="#cb98-662" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(donnees)</span>
<span id="cb98-663"><a href="#cb98-663" aria-hidden="true" tabindex="-1"></a>predictions_loo <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb98-664"><a href="#cb98-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-665"><a href="#cb98-665" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb98-666"><a href="#cb98-666" aria-hidden="true" tabindex="-1"></a>  model_cv <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">formula</span>(final_model), <span class="at">data =</span> donnees[<span class="sc">-</span>i, ])</span>
<span id="cb98-667"><a href="#cb98-667" aria-hidden="true" tabindex="-1"></a>  predictions_loo[i] <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_cv, <span class="at">newdata =</span> donnees[i, ])</span>
<span id="cb98-668"><a href="#cb98-668" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-669"><a href="#cb98-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-670"><a href="#cb98-670" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Évaluation des performances en validation croisée</span></span>
<span id="cb98-671"><a href="#cb98-671" aria-hidden="true" tabindex="-1"></a>residuals_loo <span class="ot">&lt;-</span> donnees<span class="sc">$</span>Y <span class="sc">-</span> predictions_loo</span>
<span id="cb98-672"><a href="#cb98-672" aria-hidden="true" tabindex="-1"></a>r2_cv <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(residuals_loo<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((donnees<span class="sc">$</span>Y <span class="sc">-</span> <span class="fu">mean</span>(donnees<span class="sc">$</span>Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb98-673"><a href="#cb98-673" aria-hidden="true" tabindex="-1"></a>rmse_cv <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(residuals_loo<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb98-674"><a href="#cb98-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-675"><a href="#cb98-675" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Préparation des données pour la visualisation</span></span>
<span id="cb98-676"><a href="#cb98-676" aria-hidden="true" tabindex="-1"></a>cv_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-677"><a href="#cb98-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed =</span> donnees<span class="sc">$</span>Y,</span>
<span id="cb98-678"><a href="#cb98-678" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted_Model =</span> <span class="fu">fitted</span>(final_model),</span>
<span id="cb98-679"><a href="#cb98-679" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted_CV =</span> predictions_loo</span>
<span id="cb98-680"><a href="#cb98-680" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-681"><a href="#cb98-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-682"><a href="#cb98-682" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Affichage des scores</span></span>
<span id="cb98-683"><a href="#cb98-683" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== VALIDATION CROISÉE (LOOCV) ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-684"><a href="#cb98-684" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (CV)   :"</span>, <span class="fu">round</span>(r2_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-685"><a href="#cb98-685" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE (CV) :"</span>, <span class="fu">round</span>(rmse_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-686"><a href="#cb98-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-687"><a href="#cb98-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-688"><a href="#cb98-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-689"><a href="#cb98-689" aria-hidden="true" tabindex="-1"></a><span class="fu">## Validation croisée (LOOCV)</span></span>
<span id="cb98-690"><a href="#cb98-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-691"><a href="#cb98-691" aria-hidden="true" tabindex="-1"></a>Pour évaluer la **robustesse prédictive** du modèle sélectionné, une validation croisée Leave-One-Out (LOOCV) a été réalisée. Cette méthode consiste à entraîner le modèle sur *n-1* observations, puis à tester la prédiction sur la nième, et ainsi de suite pour l’ensemble des données.</span>
<span id="cb98-692"><a href="#cb98-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-693"><a href="#cb98-693" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Résultats obtenus</span></span>
<span id="cb98-694"><a href="#cb98-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-695"><a href="#cb98-695" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**R² croisé** : 0.7946\</span>
<span id="cb98-696"><a href="#cb98-696" aria-hidden="true" tabindex="-1"></a>    → Le modèle parvient à expliquer près de **79,5 %** de la variance des données sur des observations non vues à l'entraînement.</span>
<span id="cb98-697"><a href="#cb98-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-698"><a href="#cb98-698" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**RMSE croisé** : 2.6885\</span>
<span id="cb98-699"><a href="#cb98-699" aria-hidden="true" tabindex="-1"></a>    → L’erreur quadratique moyenne sur des prédictions en dehors de l’échantillon est **raisonnable et stable**, proche de celle du modèle initial.</span>
<span id="cb98-700"><a href="#cb98-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-701"><a href="#cb98-701" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interprétation</span></span>
<span id="cb98-702"><a href="#cb98-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-703"><a href="#cb98-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le **R² CV est légèrement inférieur** au R² ajusté du modèle complet (\~0.83), ce qui est attendu car le LOOCV pénalise toute forme de surajustement.</span>
<span id="cb98-704"><a href="#cb98-704" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>L’écart modéré entre les deux scores confirme que le modèle est **généralisable** et ne dépend pas excessivement de données particulières.</span>
<span id="cb98-705"><a href="#cb98-705" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le **RMSE de validation croisée** reste contenu, ce qui traduit une **erreur de prédiction cohérente et stable** sur l’ensemble du jeu de données.</span>
<span id="cb98-706"><a href="#cb98-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-707"><a href="#cb98-707" aria-hidden="true" tabindex="-1"></a><span class="fu">### On observe:</span></span>
<span id="cb98-708"><a href="#cb98-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-709"><a href="#cb98-709" aria-hidden="true" tabindex="-1"></a>Le modèle sélectionné (<span class="in">`wt`</span>, <span class="in">`qsec`</span>, <span class="in">`am`</span>) montre une **bonne capacité de généralisation**, tout en conservant un **nombre limité de variables**.\</span>
<span id="cb98-710"><a href="#cb98-710" aria-hidden="true" tabindex="-1"></a>La validation croisée confirme la solidité du choix effectué sur des critères théoriques (AIC/BIC) et empiriques (graphes, résidus, performances).</span>
<span id="cb98-711"><a href="#cb98-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-714"><a href="#cb98-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-715"><a href="#cb98-715" aria-hidden="true" tabindex="-1"></a>p_cv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cv_data, <span class="fu">aes</span>(<span class="at">x =</span> Observed)) <span class="sc">+</span></span>
<span id="cb98-716"><a href="#cb98-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Predicted_Model, <span class="at">color =</span> <span class="st">"Ajustement"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb98-717"><a href="#cb98-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Predicted_CV, <span class="at">color =</span> <span class="st">"Validation croisée"</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb98-718"><a href="#cb98-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb98-719"><a href="#cb98-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Ajustement"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"Validation croisée"</span> <span class="ot">=</span> <span class="st">"#E46726"</span>)) <span class="sc">+</span></span>
<span id="cb98-720"><a href="#cb98-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Validation Croisée vs Ajustement"</span>,</span>
<span id="cb98-721"><a href="#cb98-721" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"R² CV ="</span>, <span class="fu">round</span>(r2_cv, <span class="dv">3</span>), <span class="st">"| R² Ajust ="</span>, <span class="fu">round</span>(<span class="fu">summary</span>(final_model)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>)),</span>
<span id="cb98-722"><a href="#cb98-722" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valeurs observées"</span>, <span class="at">y =</span> <span class="st">"Valeurs prédites"</span>, <span class="at">color =</span> <span class="st">"Type"</span>) <span class="sc">+</span></span>
<span id="cb98-723"><a href="#cb98-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_elegant</span>()</span>
<span id="cb98-724"><a href="#cb98-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-725"><a href="#cb98-725" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_cv)</span>
<span id="cb98-726"><a href="#cb98-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-727"><a href="#cb98-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-728"><a href="#cb98-728" aria-hidden="true" tabindex="-1"></a><span class="fu">### Résumé de la validation croisée</span></span>
<span id="cb98-729"><a href="#cb98-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-730"><a href="#cb98-730" aria-hidden="true" tabindex="-1"></a>Le graphique compare les valeurs observées à deux types de prédictions :</span>
<span id="cb98-731"><a href="#cb98-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-732"><a href="#cb98-732" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les prédictions issues du **modèle ajusté sur l’ensemble des données** (<span class="in">`Ajustement`</span>)</span>
<span id="cb98-733"><a href="#cb98-733" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les prédictions obtenues par **validation croisée Leave-One-Out** (<span class="in">`Validation croisée`</span>)</span>
<span id="cb98-734"><a href="#cb98-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-735"><a href="#cb98-735" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lecture des résultats</span></span>
<span id="cb98-736"><a href="#cb98-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-737"><a href="#cb98-737" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les deux nuages de points sont globalement **alignés sur la diagonale**, ce qui indique une bonne cohérence entre les prédictions et les observations.</span>
<span id="cb98-738"><a href="#cb98-738" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les points de validation croisée (orange) sont **légèrement plus dispersés** autour de la diagonale que ceux du modèle ajusté (bleu), ce qui est normal :\</span>
<span id="cb98-739"><a href="#cb98-739" aria-hidden="true" tabindex="-1"></a>    → le modèle ajusté sur tout l’échantillon a un **léger avantage optimiste**.</span>
<span id="cb98-740"><a href="#cb98-740" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les écarts entre les deux restent modérés, ce qui confirme une **stabilité du modèle**.</span>
<span id="cb98-741"><a href="#cb98-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-742"><a href="#cb98-742" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Résumé des scores</span></span>
<span id="cb98-743"><a href="#cb98-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-744"><a href="#cb98-744" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**R² ajusté** : 0.834\</span>
<span id="cb98-745"><a href="#cb98-745" aria-hidden="true" tabindex="-1"></a>    → Mesure la qualité d’ajustement sur l’échantillon complet.</span>
<span id="cb98-746"><a href="#cb98-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-747"><a href="#cb98-747" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**R² croisé** : 0.795\</span>
<span id="cb98-748"><a href="#cb98-748" aria-hidden="true" tabindex="-1"></a>    → Estimation plus réaliste de la capacité du modèle à prédire sur de nouvelles données.</span>
<span id="cb98-749"><a href="#cb98-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-750"><a href="#cb98-750" aria-hidden="true" tabindex="-1"></a>L’écart modéré entre les deux R² montre que le modèle ne souffre **ni de surajustement, ni de sous-ajustement**.\</span>
<span id="cb98-751"><a href="#cb98-751" aria-hidden="true" tabindex="-1"></a>La validation croisée confirme que le modèle retenu est **robuste, prédictif et généralisable**, en plus d’être simple et interprétable.</span>
<span id="cb98-752"><a href="#cb98-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-755"><a href="#cb98-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-756"><a href="#cb98-756" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Importance des variables</span></span>
<span id="cb98-757"><a href="#cb98-757" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">coef</span>(final_model)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb98-758"><a href="#cb98-758" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coefficients standardisés</span></span>
<span id="cb98-759"><a href="#cb98-759" aria-hidden="true" tabindex="-1"></a>  predictors <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">coef</span>(final_model))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb98-760"><a href="#cb98-760" aria-hidden="true" tabindex="-1"></a>  X_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(donnees[, predictors, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb98-761"><a href="#cb98-761" aria-hidden="true" tabindex="-1"></a>  y_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(donnees<span class="sc">$</span>Y)</span>
<span id="cb98-762"><a href="#cb98-762" aria-hidden="true" tabindex="-1"></a>  model_std <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_std <span class="sc">~</span> X_std)</span>
<span id="cb98-763"><a href="#cb98-763" aria-hidden="true" tabindex="-1"></a>  coef_std <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_std)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb98-764"><a href="#cb98-764" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-765"><a href="#cb98-765" aria-hidden="true" tabindex="-1"></a>  importance_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-766"><a href="#cb98-766" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">names</span>(coef_std),</span>
<span id="cb98-767"><a href="#cb98-767" aria-hidden="true" tabindex="-1"></a>    <span class="at">Coef_Std =</span> coef_std,</span>
<span id="cb98-768"><a href="#cb98-768" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">abs</span>(coef_std)</span>
<span id="cb98-769"><a href="#cb98-769" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb98-770"><a href="#cb98-770" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Importance)) <span class="sc">%&gt;%</span></span>
<span id="cb98-771"><a href="#cb98-771" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Importance_Pct =</span> Importance <span class="sc">/</span> <span class="fu">sum</span>(Importance) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb98-772"><a href="#cb98-772" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-773"><a href="#cb98-773" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Graphique d'importance élégant</span></span>
<span id="cb98-774"><a href="#cb98-774" aria-hidden="true" tabindex="-1"></a>  p_imp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(importance_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variable, Importance_Pct), <span class="at">y =</span> Importance_Pct)) <span class="sc">+</span></span>
<span id="cb98-775"><a href="#cb98-775" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb98-776"><a href="#cb98-776" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Importance_Pct, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb98-777"><a href="#cb98-777" aria-hidden="true" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb98-778"><a href="#cb98-778" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb98-779"><a href="#cb98-779" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Importance des Variables"</span>, </span>
<span id="cb98-780"><a href="#cb98-780" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Basée sur les coefficients standardisés"</span>,</span>
<span id="cb98-781"><a href="#cb98-781" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Importance (%)"</span>) <span class="sc">+</span></span>
<span id="cb98-782"><a href="#cb98-782" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_elegant</span>()</span>
<span id="cb98-783"><a href="#cb98-783" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-784"><a href="#cb98-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p_imp)</span>
<span id="cb98-785"><a href="#cb98-785" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-786"><a href="#cb98-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-787"><a href="#cb98-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-788"><a href="#cb98-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importance des variables</span></span>
<span id="cb98-789"><a href="#cb98-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-790"><a href="#cb98-790" aria-hidden="true" tabindex="-1"></a>Le graphique ci-dessus présente l'importance relative des variables explicatives du modèle final, calculée à partir des **coefficients standardisés**. Cette méthode permet de comparer directement l'effet de chaque variable, indépendamment de leur unité de mesure.</span>
<span id="cb98-791"><a href="#cb98-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-792"><a href="#cb98-792" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Résultats</span></span>
<span id="cb98-793"><a href="#cb98-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-794"><a href="#cb98-794" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`wt` (poids du véhicule)** est la variable la plus influente, représentant **51,2 %** de l'effet total du modèle.\</span>
<span id="cb98-795"><a href="#cb98-795" aria-hidden="true" tabindex="-1"></a>    → Cela confirme son rôle central dans la consommation de carburant (<span class="in">`mpg`</span>), déjà mis en évidence par toutes les méthodes de sélection.</span>
<span id="cb98-796"><a href="#cb98-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-797"><a href="#cb98-797" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`qsec` (temps sur 1/4 mile)** contribue à hauteur de **29,3 %**.\</span>
<span id="cb98-798"><a href="#cb98-798" aria-hidden="true" tabindex="-1"></a>    → Cette variable capte probablement des différences de performances moteur non directement expliquées par <span class="in">`hp`</span>.</span>
<span id="cb98-799"><a href="#cb98-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-800"><a href="#cb98-800" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**`am` (type de transmission)** intervient pour **19,6 %**.\</span>
<span id="cb98-801"><a href="#cb98-801" aria-hidden="true" tabindex="-1"></a>    → Son influence, bien que plus modeste, reste significative, notamment sur la consommation selon le type de boîte (automatique ou manuelle).</span>
<span id="cb98-802"><a href="#cb98-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-803"><a href="#cb98-803" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interprétation</span></span>
<span id="cb98-804"><a href="#cb98-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-805"><a href="#cb98-805" aria-hidden="true" tabindex="-1"></a>L'analyse montre que, même dans un modèle simple, la **poids du véhicule domine clairement l'explication de la consommation**, suivi par des facteurs dynamiques (<span class="in">`qsec`</span>) et mécaniques (<span class="in">`am`</span>).\</span>
<span id="cb98-806"><a href="#cb98-806" aria-hidden="true" tabindex="-1"></a>Cela confirme la **pertinence du modèle retenu**, à la fois explicatif, stable et interprétable.</span>
<span id="cb98-807"><a href="#cb98-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-808"><a href="#cb98-808" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb98-809"><a href="#cb98-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-810"><a href="#cb98-810" aria-hidden="true" tabindex="-1"></a>Souhaites-tu maintenant que je t’aide à rédiger une **conclusion finale complète** de l’analyse ? Ou un **résumé global** du notebook à insérer au début ou à la fin ?</span>
<span id="cb98-811"><a href="#cb98-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-812"><a href="#cb98-812" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb98-813"><a href="#cb98-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-816"><a href="#cb98-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-817"><a href="#cb98-817" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Résumé final élégant</span></span>
<span id="cb98-818"><a href="#cb98-818" aria-hidden="true" tabindex="-1"></a>final_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(final_model)</span>
<span id="cb98-819"><a href="#cb98-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-820"><a href="#cb98-820" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">60</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-821"><a href="#cb98-821" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"                    RÉSUMÉ FINAL</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-822"><a href="#cb98-822" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">60</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-823"><a href="#cb98-823" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Modèle sélectionné  :"</span>, best_model_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-824"><a href="#cb98-824" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variables retenues  :"</span>, <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">coef</span>(final_model))[<span class="sc">-</span><span class="dv">1</span>], <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-825"><a href="#cb98-825" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre de variables :"</span>, <span class="fu">length</span>(<span class="fu">coef</span>(final_model))<span class="sc">-</span><span class="dv">1</span>, <span class="st">"/"</span>, <span class="fu">ncol</span>(donnees)<span class="sc">-</span><span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-826"><a href="#cb98-826" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² ajusté          :"</span>, <span class="fu">round</span>(final_summary<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-827"><a href="#cb98-827" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² validation      :"</span>, <span class="fu">round</span>(r2_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-828"><a href="#cb98-828" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE               :"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(final_model)<span class="sc">^</span><span class="dv">2</span>)), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-829"><a href="#cb98-829" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE validation    :"</span>, <span class="fu">round</span>(rmse_cv, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-830"><a href="#cb98-830" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC                :"</span>, <span class="fu">round</span>(<span class="fu">AIC</span>(final_model), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-831"><a href="#cb98-831" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC                :"</span>, <span class="fu">round</span>(<span class="fu">BIC</span>(final_model), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-832"><a href="#cb98-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-833"><a href="#cb98-833" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance globale</span></span>
<span id="cb98-834"><a href="#cb98-834" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(r2_cv <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(final_summary<span class="sc">$</span>adj.r.squared <span class="sc">-</span> r2_cv) <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb98-835"><a href="#cb98-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Qualité            : ✓ Excellent</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-836"><a href="#cb98-836" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(r2_cv <span class="sc">&gt;</span> <span class="fl">0.6</span>) {</span>
<span id="cb98-837"><a href="#cb98-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Qualité            : Acceptable</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-838"><a href="#cb98-838" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb98-839"><a href="#cb98-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Qualité            : À améliorer</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-840"><a href="#cb98-840" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-841"><a href="#cb98-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-842"><a href="#cb98-842" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"="</span>, <span class="dv">60</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-843"><a href="#cb98-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-844"><a href="#cb98-844" aria-hidden="true" tabindex="-1"></a><span class="co"># Sauvegarde</span></span>
<span id="cb98-845"><a href="#cb98-845" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(final_model, <span class="st">"modele_final.rds"</span>)</span>
<span id="cb98-846"><a href="#cb98-846" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">"final_model"</span>, <span class="st">"comparison"</span>, <span class="st">"donnees"</span>, <span class="st">"importance_df"</span>), </span>
<span id="cb98-847"><a href="#cb98-847" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">"resultats_regression.RData"</span>)</span>
<span id="cb98-848"><a href="#cb98-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-849"><a href="#cb98-849" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Fichiers sauvegardés: modele_final.rds, resultats_regression.RData</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb98-850"><a href="#cb98-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-851"><a href="#cb98-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-852"><a href="#cb98-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-853"><a href="#cb98-853" aria-hidden="true" tabindex="-1"></a><span class="fu">## Et après... que faire du modèle ?</span></span>
<span id="cb98-854"><a href="#cb98-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-855"><a href="#cb98-855" aria-hidden="true" tabindex="-1"></a>Une fois le modèle final validé, il peut être réutilisé dans divers contextes :\</span>
<span id="cb98-856"><a href="#cb98-856" aria-hidden="true" tabindex="-1"></a>**prédiction**, **automatisation**, **rapport dynamique**, **déploiement applicatif**, ou encore **communication des résultats**.</span>
<span id="cb98-857"><a href="#cb98-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-858"><a href="#cb98-858" aria-hidden="true" tabindex="-1"></a>Deux méthodes de rechargement sont disponibles, selon le niveau de détail souhaité.</span>
<span id="cb98-859"><a href="#cb98-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-860"><a href="#cb98-860" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb98-861"><a href="#cb98-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-862"><a href="#cb98-862" aria-hidden="true" tabindex="-1"></a><span class="fu">### ✅ Option 1 — Charger uniquement le modèle final (léger, production)</span></span>
<span id="cb98-863"><a href="#cb98-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-864"><a href="#cb98-864" aria-hidden="true" tabindex="-1"></a>Cette option consiste à charger uniquement le modèle statistique (sans les autres objets d’analyse).\</span>
<span id="cb98-865"><a href="#cb98-865" aria-hidden="true" tabindex="-1"></a>Elle est idéale pour effectuer rapidement des **prédictions sur de nouvelles données**, ou pour intégrer le modèle dans un **pipeline**, une **API** ou une **application (ex : Shiny)**.</span>
<span id="cb98-866"><a href="#cb98-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-867"><a href="#cb98-867" aria-hidden="true" tabindex="-1"></a>**Commande :**</span>
<span id="cb98-868"><a href="#cb98-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-871"><a href="#cb98-871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-872"><a href="#cb98-872" aria-hidden="true" tabindex="-1"></a><span class="co"># # (utiliser cette ligne seule si tu veux juste faire des prédictions)</span></span>
<span id="cb98-873"><a href="#cb98-873" aria-hidden="true" tabindex="-1"></a><span class="co"># modele &lt;- readRDS("modele_final.rds")</span></span>
<span id="cb98-874"><a href="#cb98-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-875"><a href="#cb98-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-876"><a href="#cb98-876" aria-hidden="true" tabindex="-1"></a><span class="fu">### Option 2 — Recharger l’environnement complet de l’analyse (`.RData`)</span></span>
<span id="cb98-877"><a href="#cb98-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-878"><a href="#cb98-878" aria-hidden="true" tabindex="-1"></a>Lorsque l’on souhaite **reprendre, approfondir, enrichir ou documenter** une analyse déjà réalisée, il est conseillé d’utiliser le fichier <span class="in">`.RData`</span>, qui contient l’ensemble des objets de travail sauvegardés à la fin du projet.</span>
<span id="cb98-879"><a href="#cb98-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-880"><a href="#cb98-880" aria-hidden="true" tabindex="-1"></a>Cela permet de **gagner du temps**, d’éviter de relancer tous les calculs, et d’assurer une **traçabilité complète** des étapes effectuées.</span>
<span id="cb98-881"><a href="#cb98-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-882"><a href="#cb98-882" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb98-883"><a href="#cb98-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-884"><a href="#cb98-884" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Commande</span></span>
<span id="cb98-885"><a href="#cb98-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-888"><a href="#cb98-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-889"><a href="#cb98-889" aria-hidden="true" tabindex="-1"></a>modele <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"modele_final.rds"</span>)</span>
<span id="cb98-890"><a href="#cb98-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-891"><a href="#cb98-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-892"><a href="#cb98-892" aria-hidden="true" tabindex="-1"></a><span class="fu">### Faire une prédiction à partir de notre modele</span></span>
<span id="cb98-893"><a href="#cb98-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-896"><a href="#cb98-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb98-897"><a href="#cb98-897" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Créer une nouvelle observation (même structure que les données d'entraînement)</span></span>
<span id="cb98-898"><a href="#cb98-898" aria-hidden="true" tabindex="-1"></a>nouvelles_donnees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-899"><a href="#cb98-899" aria-hidden="true" tabindex="-1"></a>  <span class="at">cyl   =</span> <span class="dv">6</span>,     <span class="co"># Nombre de cylindres</span></span>
<span id="cb98-900"><a href="#cb98-900" aria-hidden="true" tabindex="-1"></a>  <span class="at">disp  =</span> <span class="dv">200</span>,   <span class="co"># Cylindrée (en pouces cubes)</span></span>
<span id="cb98-901"><a href="#cb98-901" aria-hidden="true" tabindex="-1"></a>  <span class="at">hp    =</span> <span class="dv">150</span>,   <span class="co"># Puissance (horsepower)</span></span>
<span id="cb98-902"><a href="#cb98-902" aria-hidden="true" tabindex="-1"></a>  <span class="at">drat  =</span> <span class="fl">3.5</span>,   <span class="co"># Rapport du pont arrière</span></span>
<span id="cb98-903"><a href="#cb98-903" aria-hidden="true" tabindex="-1"></a>  <span class="at">wt    =</span> <span class="fl">3.2</span>,   <span class="co"># Poids (en milliers de livres)</span></span>
<span id="cb98-904"><a href="#cb98-904" aria-hidden="true" tabindex="-1"></a>  <span class="at">qsec  =</span> <span class="dv">18</span>,    <span class="co"># Temps au quart de mile</span></span>
<span id="cb98-905"><a href="#cb98-905" aria-hidden="true" tabindex="-1"></a>  <span class="at">vs    =</span> <span class="dv">0</span>,     <span class="co"># Type de moteur (0 = V, 1 = ligne)</span></span>
<span id="cb98-906"><a href="#cb98-906" aria-hidden="true" tabindex="-1"></a>  <span class="at">am    =</span> <span class="dv">1</span>,     <span class="co"># Transmission (0 = auto, 1 = manuelle)</span></span>
<span id="cb98-907"><a href="#cb98-907" aria-hidden="true" tabindex="-1"></a>  <span class="at">gear  =</span> <span class="dv">4</span>,     <span class="co"># Nombre de vitesses</span></span>
<span id="cb98-908"><a href="#cb98-908" aria-hidden="true" tabindex="-1"></a>  <span class="at">carb  =</span> <span class="dv">2</span>      <span class="co"># Nombre de carburateurs</span></span>
<span id="cb98-909"><a href="#cb98-909" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-910"><a href="#cb98-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-911"><a href="#cb98-911" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Prédire la consommation (mpg) pour cette observation</span></span>
<span id="cb98-912"><a href="#cb98-912" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele, <span class="at">newdata =</span> nouvelles_donnees)</span>
<span id="cb98-913"><a href="#cb98-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-914"><a href="#cb98-914" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Afficher proprement le résultat</span></span>
<span id="cb98-915"><a href="#cb98-915" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prediction, <span class="dv">2</span>))</span>
<span id="cb98-916"><a href="#cb98-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb98-917"><a href="#cb98-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-918"><a href="#cb98-918" aria-hidden="true" tabindex="-1"></a><span class="fu">### Faire des prédictions avec le modèle final (si haut)</span></span>
<span id="cb98-919"><a href="#cb98-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-920"><a href="#cb98-920" aria-hidden="true" tabindex="-1"></a>Une fois le modèle rechargé (<span class="in">`readRDS()`</span> ou <span class="in">`load()`</span>), il est possible d’utiliser la fonction <span class="in">`predict()`</span> pour estimer la valeur cible (<span class="in">`mpg`</span>) à partir de nouvelles données.</span>
<span id="cb98-921"><a href="#cb98-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-922"><a href="#cb98-922" aria-hidden="true" tabindex="-1"></a>Le tableau ci-dessous présente les valeurs des variables explicatives pour une voiture hypothétique :</span>
<span id="cb98-923"><a href="#cb98-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-924"><a href="#cb98-924" aria-hidden="true" tabindex="-1"></a>| cyl | disp | hp  | drat | wt  | qsec | vs  | am  | gear | carb |</span>
<span id="cb98-925"><a href="#cb98-925" aria-hidden="true" tabindex="-1"></a>|-----|------|-----|------|-----|------|-----|-----|------|------|</span>
<span id="cb98-926"><a href="#cb98-926" aria-hidden="true" tabindex="-1"></a>| 6   | 200  | 150 | 3.5  | 3.2 | 18   | 0   | 1   | 4    | 2    |</span>
<span id="cb98-927"><a href="#cb98-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-928"><a href="#cb98-928" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb98-929"><a href="#cb98-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-930"><a href="#cb98-930" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Résultat de la prédiction</span></span>
<span id="cb98-931"><a href="#cb98-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-932"><a href="#cb98-932" aria-hidden="true" tabindex="-1"></a>| Observation | mpg prédit |</span>
<span id="cb98-933"><a href="#cb98-933" aria-hidden="true" tabindex="-1"></a>|-------------|------------|</span>
<span id="cb98-934"><a href="#cb98-934" aria-hidden="true" tabindex="-1"></a>| 1           | **22.09**  |</span>
<span id="cb98-935"><a href="#cb98-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-936"><a href="#cb98-936" aria-hidden="true" tabindex="-1"></a>Le modèle prédit que ce véhicule aura une consommation estimée à **22.09 miles par gallon**.</span>
<span id="cb98-937"><a href="#cb98-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-938"><a href="#cb98-938" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conseil: </span></span>
<span id="cb98-939"><a href="#cb98-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-940"><a href="#cb98-940" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les **variables doivent avoir les mêmes noms et types** que celles utilisées à l'entraînement.</span>
<span id="cb98-941"><a href="#cb98-941" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>On peux prédire plusieurs lignes à la fois en passant un <span class="in">`data.frame`</span> avec plusieurs observations.</span>
<span id="cb98-942"><a href="#cb98-942" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Pour des usages fréquents, il est recommandé d'encapsuler le tout dans une fonction <span class="in">`predict_mpg()`</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>